<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; Introduction – MA32011</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./1DFlows.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<meta name="shinylive:serviceworker_dir" content=".">
<script src="site_libs/quarto-contrib/shinylive-0.10.7/shinylive/load-shinylive-sw.js" type="module"></script>
<script src="site_libs/quarto-contrib/shinylive-0.10.7/shinylive/run-python-blocks.js" type="module"></script>
<link href="site_libs/quarto-contrib/shinylive-0.10.7/shinylive/shinylive.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/shinylive-quarto-css/shinylive-quarto.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/foldbox/foldbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>
.Conjecture {
  --color1: #948bde;
  --color2: #584eab;
}
.Lemma {
  --color1: #948bde;
  --color2: #584eab;
}
.Proof {
  --color1: #c0c0c0;
  --color2: #808080;
}
.Corollary {
  --color1: #948bde;
  --color2: #584eab;
}
.Definition {
  --color1: #d999d3;
  --color2: #a01793;
}
.Theorem {
  --color1: #948bde;
  --color2: #584eab;
}
.Feature {
  --color1: #c0c0c0;
  --color2: #808080;
}
.DONE {
  --color1: #cce7b1;
  --color2: #86b754;
}
.Solution {
  --color1: #c0c0c0;
  --color2: #808080;
}
.TODO {
  --color1: #e7b1b4;
  --color2: #8c3236;
}
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MA32011</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/dundeemath/MA32011/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./MA32011.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">1D flows</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1DFlows.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Flows on the line</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PythonAppendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Python</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#discrete-v-continuous-time" id="toc-discrete-v-continuous-time" class="nav-link active" data-scroll-target="#discrete-v-continuous-time"><span class="header-section-number">1.1</span> Discrete v continuous time</a>
  <ul class="collapse">
  <li><a href="#differential-equations" id="toc-differential-equations" class="nav-link" data-scroll-target="#differential-equations"><span class="header-section-number">1.1.1</span> Differential equations</a></li>
  <li><a href="#difference-equations" id="toc-difference-equations" class="nav-link" data-scroll-target="#difference-equations"><span class="header-section-number">1.1.2</span> Difference equations</a></li>
  <li><a href="#key-questions-to-ask-of-a-dynamical-system" id="toc-key-questions-to-ask-of-a-dynamical-system" class="nav-link" data-scroll-target="#key-questions-to-ask-of-a-dynamical-system"><span class="header-section-number">1.1.3</span> Key questions to ask of a dynamical system</a></li>
  </ul></li>
  <li><a href="#autonomous-v-nonautonomous-odes" id="toc-autonomous-v-nonautonomous-odes" class="nav-link" data-scroll-target="#autonomous-v-nonautonomous-odes"><span class="header-section-number">1.2</span> Autonomous v nonautonomous ODEs</a></li>
  <li><a href="#linear-v-nonlinear" id="toc-linear-v-nonlinear" class="nav-link" data-scroll-target="#linear-v-nonlinear"><span class="header-section-number">1.3</span> Linear v Nonlinear</a></li>
  <li><a href="#quantitative-v-qualitative-solutions" id="toc-quantitative-v-qualitative-solutions" class="nav-link" data-scroll-target="#quantitative-v-qualitative-solutions"><span class="header-section-number">1.4</span> Quantitative v qualitative solutions</a></li>
  <li><a href="#representing-solutions" id="toc-representing-solutions" class="nav-link" data-scroll-target="#representing-solutions"><span class="header-section-number">1.5</span> Representing solutions</a></li>
  <li><a href="#fixed-points-and-their-stability" id="toc-fixed-points-and-their-stability" class="nav-link" data-scroll-target="#fixed-points-and-their-stability"><span class="header-section-number">1.6</span> Fixed points and their stability</a></li>
  <li><a href="#uniqueness-and-existence" id="toc-uniqueness-and-existence" class="nav-link" data-scroll-target="#uniqueness-and-existence"><span class="header-section-number">1.7</span> Uniqueness and existence</a></li>
  <li><a href="#nondimensionalisation" id="toc-nondimensionalisation" class="nav-link" data-scroll-target="#nondimensionalisation"><span class="header-section-number">1.8</span> Nondimensionalisation</a></li>
  <li><a href="#numerical-solutions" id="toc-numerical-solutions" class="nav-link" data-scroll-target="#numerical-solutions"><span class="header-section-number">1.9</span> Numerical solutions</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/dundeemath/MA32011/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The goal of this module is to provide an introduction to dynamical systems. We will introduce key mathematical concepts and explore examples from physics and biology.</p>
<p>To begin with we introduce some key terminology.</p>
<section id="discrete-v-continuous-time" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="discrete-v-continuous-time"><span class="header-section-number">1.1</span> Discrete v continuous time</h2>
<section id="differential-equations" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="differential-equations"><span class="header-section-number">1.1.1</span> Differential equations</h3>
<p>Let <span class="math inline">\(t\)</span> be a continuous variable and <span class="math inline">\(x=x(t)\)</span>. Consider the ordinary differential equation (ODE) <span id="eq-logdemo"><span class="math display">\[
\dot{x}=rx(1-x).
\tag{1.1}\]</span></span></p>
<p><span class="math inline">\(\dot{x}\)</span> is used to denote the time derivative, i.e. <span class="math display">\[
\dot{x}:=\frac{dx}{dt}.
\]</span></p>
<p>Similarly, the second order derivative is represented by <span class="math display">\[
\ddot{x}:=\frac{d^2x}{dt^2}.
\]</span></p>
<p>Many of the second order ODE problems that we will examine originate from Newton’s Second Law, i.e.</p>
<p><span class="math display">\[
m\ddot{x}=F(x)
\]</span> where <span class="math inline">\(x(t)\)</span> represents the position of a particle at time, <span class="math inline">\(t\)</span>, <span class="math inline">\(m\)</span> represents a constant particle mass and <span class="math inline">\(F\)</span> a resultant force.</p>
<p>Consider the case in which <span class="math inline">\(F\)</span> represents a linear restoring force, i.e. <span class="math display">\[
F(x)=-kx.
\]</span> The equation of motion can be written as <span id="eq-secondorderODE"><span class="math display">\[
\ddot{x}=-\mu x,
\tag{1.2}\]</span></span> where <span class="math inline">\(\mu=-k/m\)</span>.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.1</strong></span> The app in <a href="#fig-popmodel" class="quarto-xref">Figure&nbsp;<span>1.1</span></a> encodes a numerical solution of the second order ODE</p>
<p><span class="math display">\[
a\ddot{x}+b\dot{x}+cx=0.
\]</span></p>
<p>Use the app to:</p>
<ul>
<li>identify appropriate values of the parameters <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> so that the solution captures the case of a particle of mass (<span class="math inline">\(m\)</span>) equal to 3 subjected to a linear restoring force with spring constant (<span class="math inline">\(k\)</span>) equal to 5.</li>
<li>explore the dependence of oscillation period on initial conditions.</li>
</ul>
<p>Is the behaviour of the numerical solution consistent with <a href="#eq-secondorderODE" class="quarto-xref">Equation&nbsp;<span>1.2</span></a>.</p>
</div>
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-popmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<pre class="shinylive-python" data-engine="python"><code>#| '!! shinylive warning !!': |
#|   shinylive does not work in self-contained HTML documents.
#|   Please set `embed-resources: false` in your metadata.
#| standalone: true
#| components: [viewer]
#| viewerHeight: 800

from shiny import App, Inputs, Outputs, Session, render, ui
from shiny import reactive

import numpy as np
from pathlib import Path
import matplotlib.pyplot as plt
from scipy.integrate import odeint

app_ui = ui.page_fluid(
    ui.input_slider(id="a",label="a",min=0.01,max=3,value=0.1,step=0.001),
    ui.input_slider(id="b",label="b",min=0.0,max=15.0,value=10.0,step=0.1),             
    ui.input_slider(id="c",label="c",min=0.0,max=30.0,value=5.0,step=1.0),   
    ui.input_slider(id="y0",label="x(t=0)",min=0.0,max=20.0,value=5.0,step=1.0),
    ui.input_slider(id="y0p",label="dx/dt(t=0)",min=0.0,max=20.0,value=1,step=1.0),
    ui.input_slider(id="T",label="Simulation time",min=0.0,max=60.0,value=20.0,step=0.5),
        ui.output_plot("plot"),
)

def server(input, output, session):
    
    @render.plot
    def plot():
        fig, ax = plt.subplots()
        #ax.set_ylim([-2, 2])
        # Filter fata
        
        
        a=float(input.a())
        b=float(input.b())
        c=float(input.c())
        y_0=float(input.y0())
        y_0_p=float(input.y0p())
        T=float(input.T())
        

        
        # Define rhs of LV ODEs
        def rhs_pop_model(y,t,a,b,c):
          rhs=np.zeros_like(y,dtype=float)

          z=y[1]

          #ay'' + by'+cy=0
          # y'=z
          # z'=y''=-(by'+cy)/a


          dy_dt=y[1]
          dz_dt=-(b*z+c*y[0])/a

          rhs[0]=dy_dt
          rhs[1]=dz_dt

          return rhs

        # Define discretised t domain
        t = np.linspace(0, T, 1000)

        # define initial conditions
        init_cond=[y_0,y_0_p]
        
        # Compute numerical solution of ODEs
        sol1 = odeint(rhs_pop_model, init_cond,t,args=(a,b,c))

        # Plot results
        y=sol1[:,0]
        yp=sol1[:,1]
        
        
        ax.plot(t, y)
        ax.set_xlabel('$t$')
        ax.set_ylabel('$x(t)$')

        plt.grid()
        #plt.show()
    
app = App(app_ui, server)</code></pre>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-popmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.1: Exploring numerical solutions of a linear second order ODE.
</figcaption>
</figure>
</section>
<section id="difference-equations" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="difference-equations"><span class="header-section-number">1.1.2</span> Difference equations</h3>
<p>Suppose that <span class="math inline">\(n\)</span> is a discrete variable. Let <span class="math inline">\(y_n\)</span> represent a dependent variable at iteration <span class="math inline">\(n\)</span>. Consider the difference equation <span class="math display">\[
y_{n+1}=ry_n(1-y_n),
\]</span> where <span class="math inline">\(r\in \Re\)</span>.</p>
<p>See this <a href="https://dundeemath.github.io/Admissions/posts/RecurrenceRelations.html">link</a> for exploration of model solutions.</p>
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-logisticmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<pre class="shinylive-python" data-engine="python"><code>#| '!! shinylive warning !!': |
#|   shinylive does not work in self-contained HTML documents.
#|   Please set `embed-resources: false` in your metadata.
#| standalone: true
#| viewerHeight: 800




from shiny import App, Inputs, Outputs, Session, render, ui
from shiny import reactive

import numpy as np
from pathlib import Path
import matplotlib.pyplot as plt
from scipy.integrate import odeint

app_ui = ui.page_fluid(
                 
    ui.input_slider(id="u0",label="u_0",min=0.0,max=1.0,value=0.5,step=0.01),
    ui.input_slider(id="T",label="Number of iterations",min=0.0,max=60.0,value=20.0,step=1.0),
    ui.input_slider(id="r_range",label="r zoomed",min=0.0,max=4.0,value=[0.0,4.0],step=0.001),
    ui.input_slider(id="u_range",label="u zoomed",min=0.0,max=1.0,value=[0.0,1.0],step=0.01),ui.output_plot("plot"),
    ui.input_slider(id="r",label="r",min=0.0,max=5.0,value=0.1,step=0.001),
)

def server(input, output, session):
    @output
    @render.plot
    def plot():
        fig, ax = plt.subplots(3,1,figsize=(12, 4))
        #ax.set_ylim([-2, 2])
        # Filter fata
        
        
        r=float(input.r())
        u0=float(input.u0())
        T=int(input.T())
        r_min=float(input.r_range()[0])
        r_max=float(input.r_range()[1])
        u_min=float(input.u_range()[0])
        u_max=float(input.u_range()[1])


        # Define rhs of logistic map 
        def logistic_map(y,t,r):
          rhs=r*y*(1-y)
          return rhs
        
        def DiscreteSol(rhs_pop_model,y_0,t,r):
            y=np.zeros_like(t,dtype=float)
            y[0]=y_0
            for i in t:
                if i&gt;0:

                    y[i]=rhs_pop_model(y[i-1],t[i],r)
            return y

        # Define discretised t domain
        t = np.arange(0, T, 1)
        # define initial conditions
        init_cond=u0
        
        # Compute numerical solution of ODEs
        sol1 = DiscreteSol(logistic_map,init_cond,t,r)

        # Plot results
        y=sol1
        
        ax[0].plot(t,y)
        ax[0].set_xlabel('$n$')
        ax[0].set_ylabel('$y_n$')

        plt.grid()

        # Parameters
        n_iterations = 1000  # total iterations for each value of r
        n_last = 100         # number of iterations to plot (for steady state)
        r_values = np.linspace(0.0, 4.0, 10000)  # range of r values
        u0 = 0.5  # initial population (seed)

        delta=0.25
        #r_min=r-delta
        #r_max=r+delta

        r_values2 = np.linspace(r_min, r_max, 10000)  # range of r values

        # Initialize plot
        x = np.full_like(r_values, u0)
        x2 = np.full_like(r_values2, u0)

        # Iterate and plot bifurcation diagram
         
        for _ in range(n_iterations):
            x = r_values * x * (1 - x)  # logistic map function
            x2 = r_values2 * x2 * (1 - x2)  # logistic map function

            if _ &gt;= (n_iterations - n_last):  # plot only steady state
                ax[1].plot(r_values, x, ',k', alpha=0.25)
                ax[1].plot([r,r],[0,1],'r--')
                ax[2].plot(r_values2, x2, ',k', alpha=0.25)
                ax[2].plot([r,r],[0,1],'r--')

            # Labels and display
            ax[1].set_title("Bifurcation Diagram")
            ax[1].set_xlabel("$r$")
            ax[1].set_ylabel("$y^*$")
            ax[2].set_title("Bifurcation Diagram (zoomed in) ")
            ax[2].set_xlabel("$r$")
            ax[2].set_ylabel("$y^*$")
            ax[2].set_xlim([r_min,r_max])
            ax[2].set_ylim([u_min,u_max])



        plt.show()
    
app = App(app_ui, server)</code></pre>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-logisticmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.2: Exploring behaviour of the logistic map using numerical solutions and bifurcation diagrams.
</figcaption>
</figure>
</section>
<section id="key-questions-to-ask-of-a-dynamical-system" class="level3" data-number="1.1.3">
<h3 data-number="1.1.3" class="anchored" data-anchor-id="key-questions-to-ask-of-a-dynamical-system"><span class="header-section-number">1.1.3</span> Key questions to ask of a dynamical system</h3>
<ul>
<li>do solutions exist? If so are they unique?</li>
<li>Is there an explicit solution?</li>
<li>Can we qualitatively describe solution behaviour?</li>
<li>How do the solutions depend on the model parameters?</li>
<li>Are their critical values of parameters where solution behaviour changes?</li>
</ul>
</section>
</section>
<section id="autonomous-v-nonautonomous-odes" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="autonomous-v-nonautonomous-odes"><span class="header-section-number">1.2</span> Autonomous v nonautonomous ODEs</h2>
<p>For an autonomous system, the update does not explicitly depend on the independent variable. <a href="#eq-logdemo" class="quarto-xref">Equation&nbsp;<span>1.1</span></a> is autonomous. But <span class="math display">\[
\dot{x}=rx(1-x+t)
\]</span> is nonautonomous (because of the explicit time dependence on the right-hand side).</p>
</section>
<section id="linear-v-nonlinear" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="linear-v-nonlinear"><span class="header-section-number">1.3</span> Linear v Nonlinear</h2>
<p>Linear systems satisfy a linear supposition principle: a sum of solutions is itself a solution. In general, this property does not hold for nonlinear systems.</p>
<p>In linear dynamical systems, the dynamics are a function of linear sums of the dependent variables. Hence</p>
<p><span id="eq-linex"><span class="math display">\[
\dot{x}=-x
\tag{1.3}\]</span></span> is a linear ordinary differential equation (ODE). But <span id="eq-nonlinex"><span class="math display">\[
\dot{x}=-x^2
\tag{1.4}\]</span></span> is nonlinear.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.2</strong></span> Integrate each of <a href="#eq-linex" class="quarto-xref">Equation&nbsp;<span>1.3</span></a> and eq-nonlinex. Use the solutions to demonstrate that the principle of linear superpositions holds for <span class="quarto-unresolved-ref">?eq-lines</span> but not for <a href="#eq-nonlinex" class="quarto-xref">Equation&nbsp;<span>1.4</span></a>.</p>
</div>
</section>
<section id="quantitative-v-qualitative-solutions" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="quantitative-v-qualitative-solutions"><span class="header-section-number">1.4</span> Quantitative v qualitative solutions</h2>
<p>You are likely used to solving problems in which an explicit solution can be found. For example, consider the ODE <span class="math display">\[
\dot{x}=-kx, \quad  x(0)=x_0
\]</span> where <span class="math inline">\(k,x_0 \in \Re^+\)</span> .</p>
<p>We can integrate and express the solution as</p>
<p><span class="math display">\[
x(t)=x_0e^{-kt}
\]</span></p>
<p>Using the explicit solution we can then answer questions about its behaviour. For example, let’s say we want to find the time, <span class="math inline">\(t^*\)</span>, at which the solution is half it’s maximum. Hence <span class="math display">\[
x(t*)=x_0/2 \implies t^* = \frac{\ln 2}{k}.
\]</span></p>
<p>However, almost all problems that we will encounter in the study of nonlinear systems will not have an explicit solution. For example, consider the nonlinear ODE</p>
<p><span class="math display">\[
\dot{x}=-\frac{k\sin(x)+\sqrt{x}}{1+x}, \quad  x(0)=x_0,
\]</span> where <span class="math inline">\(0&lt;x_0&lt;\pi\)</span>.</p>
<p>I cannot integrate this equation in order to find solutions in terms of standard functions. Hence I cannot <em>quantitatively</em> describe the solution. However, I can identify that</p>
<p><span class="math display">\[
\dot{x}&lt;0, \  \forall \  0&lt;x&lt;\pi.
\]</span></p>
<p>Hence the solution will decrease in value from the given initial condition and tend to zero as <span class="math inline">\(t\rightarrow \infty\)</span>. This is an example of a <em>qualitative</em> analysis.</p>
</section>
<section id="representing-solutions" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="representing-solutions"><span class="header-section-number">1.5</span> Representing solutions</h2>
<p>It is useful to define some important concepts that are used to describe the solutions of a dynamical system. Consider an ODE <span class="math display">\[
\dot{\mathbf{x}}=\mathbf{f}(\mathbf{x}), \quad \mathbf{x}(0)=\mathbf{x}_0,
\]</span> where <span class="math inline">\(\mathbf{f}\)</span> is a prescribed function and <span class="math inline">\(\mathbf{x}_0\)</span> is an initial condition.</p>
<ul>
<li><em>phase space</em> - a Cartesian coordinate system with dependent variables represented on Cartesian axes</li>
<li><em>phase point</em> - value of the solution at given time point</li>
<li><em>vector field</em> - the derivative of the solution, i.e.&nbsp;<span class="math inline">\(\mathbf{f}\)</span>.</li>
<li><em>trajectory</em> - a line in phase space that traces out a solution as time evolves (must be tangential to vector field)</li>
<li><em>phase portrait</em> - collection of trajectories (i.e.&nbsp;solutions with different initial conditions)</li>
</ul>
</section>
<section id="fixed-points-and-their-stability" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="fixed-points-and-their-stability"><span class="header-section-number">1.6</span> Fixed points and their stability</h2>
<p>Many of the dynamical systems that we will study will be nonlinear. Hence it will not be possible to compute exact solutions.</p>
<p>The behaviour of dynamical systems can often be understood by considering the fixed points, i.e.&nbsp;values of the dependent variables at which the dynamics are at steady state.</p>
<p>Stability analyses are used to investigate the dynamics of perturbations about the steady state.</p>
</section>
<section id="uniqueness-and-existence" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="uniqueness-and-existence"><span class="header-section-number">1.7</span> Uniqueness and existence</h2>
<p>We will restrict ourselves to problems in which the vector fields are sufficiently <em>well behaved</em> such that unique solutions exist.</p>
<p>However, it is noted that problems can be identified where solutions do not exist or where multiple solutions exist.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.3</strong></span> Show that the solution to the ODE <span class="math display">\[
\dot{x}=x^2 \quad x(0)=2
\]</span> blows up after a finite time.</p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.4</strong></span> Show that the solution to the ODE <span class="math display">\[
\dot{x}=\sqrt{x} \quad x(0)=0
\]</span> is given by <span class="math display">\[
x=\begin{cases}
&amp;0 \ \  &amp;t\leq\delta \\
&amp;\frac{(t-\delta)^2}{4}&gt;\delta \ &amp;t&gt; \delta
\end{cases}
\]</span> for any <span class="math inline">\(\delta &gt;0\)</span>.</p>
</div>
</section>
<section id="nondimensionalisation" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="nondimensionalisation"><span class="header-section-number">1.8</span> Nondimensionalisation</h2>
<p>In real world problems, variables and parameters typically have units (e.g.&nbsp;time - seconds, Force - Newtons etc.). We can nondimensionalise problems by defining rescaled variables. This process can be used to justify simplifications to models and to reduce the number of parameters.</p>
</section>
<section id="numerical-solutions" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="numerical-solutions"><span class="header-section-number">1.9</span> Numerical solutions</h2>
<p>Numerical solutions are used to numerically compute approximate solutions to problems. The simplest example of a numerical method in a dynamical system is the forward Euler method. Suppose we want to study the ODE</p>
<p><span class="math display">\[
\dot{x}=f(x), \quad x(0)=x_0, \quad 0&lt;t&lt;T.
\]</span></p>
<p>Discretise the independent variable <span class="math inline">\(t\)</span> by defining <span class="math inline">\(t=0\)</span>,<span class="math inline">\(\Delta t\)</span>,<span class="math inline">\(2\Delta t\)</span>,…,<span class="math inline">\(T=N\Delta T\)</span>.</p>
<p>Approximate the time derivative</p>
<p><span class="math display">\[
\dot{x}=\frac{dx}{dt}\sim \frac{x(t+\Delta t)-x(t)}{\Delta t}
\]</span></p>
<p>Hence the solution at time <span class="math inline">\(t+\Delta t\)</span> can be approximated by <span class="math display">\[
x(t+\Delta t)=x(t)+\Delta t f(x(t)).
\]</span></p>
<p>Given an initial condition <span class="math inline">\(x(0)=a\)</span> we can compute the approximate solution at time <span class="math inline">\(\Delta t\)</span>. Further iteration then allows an approximate solution to be calculated.</p>
<p>Numerical solutions provide a a very useful way to explore solution behaviour. However, they describe the quantitative behaviour of a solution for a particular initial condition and set of parameter values.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.5</strong></span> The app in <a href="#fig-forwardEuler" class="quarto-xref">Figure&nbsp;<span>1.3</span></a> uses the Forward Euler method to compute numerical solutions of the ODE <span class="math display">\[
\dot{x}=a+bx+cx^2
\]</span> in the domain <span class="math inline">\([0,T]\)</span> with initial condition <span class="math display">\[
x(0)=x_0.
\]</span></p>
<ol type="1">
<li>Choose model parameters so that the app solves the ODE <span class="math display">\[
\dot{x}=-bx, \quad x(0)=x_0.
\]</span> and the numerical solution agrees with the exact solution (dashed line).</li>
<li>Show that the numerical error increases with <span class="math inline">\(\Delta t\)</span>.</li>
</ol>
</div>
<div id="fig-forwardEuler" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-forwardEuler-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<pre class="shinylive-python" data-engine="python"><code>#| '!! shinylive warning !!': |
#|   shinylive does not work in self-contained HTML documents.
#|   Please set `embed-resources: false` in your metadata.
#| standalone: true
#| viewerHeight: 800




from shiny import App, Inputs, Outputs, Session, render, ui
from shiny import reactive

import numpy as np
from pathlib import Path
import matplotlib.pyplot as plt
from scipy.integrate import odeint

app_ui = ui.page_fluid(
                 
    ui.input_slider(id="x0",label="x_0",min=0.0,max=10.0,value=0.5,step=0.01),
    ui.input_slider(id="T",label="T",min=0.0,max=60.0,value=20.0,step=1.0),
    ui.input_slider(id="a",label="a",min=-5.0,max=5.0,value=-1.0,step=0.01),
    ui.input_slider(id="b",label="b",min=-5.0,max=5.0,value=2.0,step=0.01),ui.output_plot("plot"),
    ui.input_slider(id="c",label="c",min=-5.0,max=5.0,value=0.1,step=0.01),
    ui.input_slider(id="dt",label="dt",min=0.0,max=1.0,value=0.01,step=0.001),
)

def server(input, output, session):
    @output
    @render.plot
    def plot():
        fig, ax = plt.subplots(1,1,figsize=(12, 4))
       
        x0=float(input.x0())
        T=float(input.T())
        a=float(input.a())
        b=float(input.b())
        c=float(input.c())
        dt=float(input.dt())


        # Define rhs of logistic map 
        def oderhs(y,a,b,c):
          rhs=a+b*y+c*y**2
          return rhs
        
        def FESol(y_0,t,a,b,c,dt):
            y=np.zeros_like(t,dtype=float)
            y[0]=y_0
            for i in range(len(t)):
                if i&gt;0:
                    y[i]=y[i-1]+dt*oderhs(y[i-1],a,b,c)
            return y

        N=int(np.ceil(T/dt))
        # Define discretised t domain
        t = np.linspace(0, T,N)
        
        # Compute numerical solution of ODEs
        sol1 = FESol(x0,t,a,b,c,dt)

        # Plot results
        y=sol1
        
        model_sol=x0*np.exp(b*t)
        ax.plot(t,y,t,model_sol,'--')
        ax.set_xlabel('$t$')
        ax.set_ylabel('$x(t)$')
        ax.set_ylim([0,2*x0])

        fig.legend(['Num','$x_0e^{bt}$'])

        plt.grid()

        plt.show()
    
app = App(app_ui, server)</code></pre>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-forwardEuler-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.3: Numerical solution of an ODE with a quadratic right-hand side.
</figcaption>
</figure>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Preface">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./1DFlows.html" class="pagination-link" aria-label="Flows on the line">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Flows on the line</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/dundeemath/MA32011/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>