[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "MA32011",
    "section": "",
    "text": "Preface\nWelcome to the module MA32011 Dynamical systems.\nMy name is Philip Murray and I am the module lead.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#how-to-contact-me",
    "href": "index.html#how-to-contact-me",
    "title": "MA32011",
    "section": "How to contact me?",
    "text": "How to contact me?\n\nemail: pmurray@dundee.ac.uk\noffice: G11, Fulton Building\nTeams: PM me",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#lecture-notes",
    "href": "index.html#lecture-notes",
    "title": "MA32011",
    "section": "Lecture notes",
    "text": "Lecture notes\nYou can find lecture notes for the module on this page. If you would like a pdf this can be easily generated by clicking on the pdf link of the webpage. I will occasionally edit/update the notes as we proceed through lectures. If you spot any errors, typos or omissions please let me know.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#reading",
    "href": "index.html#reading",
    "title": "MA32011",
    "section": "Reading",
    "text": "Reading\nNonlinear dynamics and chaos, Steven Strogatz Strogatz (2001) Mathematical Biology I, Murray (2002)",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#python-codes",
    "href": "index.html#python-codes",
    "title": "MA32011",
    "section": "Python codes",
    "text": "Python codes\nI have provided Python codes for most of the figures in the notes (you can unfold code section by clicking `Code’). Note that the Python code does not appear in the pdf.\nMany of you have taken the Introduction to Programming module at Level 2 and have therefore some experience using Python. I strongly encourage you to use the provided codes as a tool to play around with numerical solutions of the various models that we will be working on. The codes should run as standalone Python codes.\n\n\n\n\n\n\nNote\n\n\n\nTo access Python on Uni machines:\n\nLaunch Anaconda from AppsAnywhere\nWhen a folder opens, double click on Spyder.\nPaste a code from lecture notes into the editor on the left-hand side.\nClick on the green arrow to run the code.\nThe plots should appear in the plots tab on the right-hand side.\nExperiment with the code. When you change a model parameter, does the solution change in an expected way?\n\n\n\nI have also provided some examples of how to use Python as a symbolic calculator. This uses a Python library called sympy and is quite similar to Maple.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#assessment",
    "href": "index.html#assessment",
    "title": "MA32011",
    "section": "Assessment",
    "text": "Assessment\n\nFinal exam (80 %)\n2 class tests (8 % each), Week 7 and 11\n4 quizes (1 % each), Week 2,4,6 and 9",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#plan",
    "href": "index.html#plan",
    "title": "MA32011",
    "section": "Plan",
    "text": "Plan\n\nProjected delivery\n\n\nWeek\nUp to Section\nTutorial sheet\nAssessment\n\n\n\n\n1\n\n1\n\n\n\n2\n\n1\nQuiz 1\n\n\n3\n\n2\n\n\n\n4\n\n2\nQuiz 2\n\n\n5\n\n3\n\n\n\n6\n\n3\nQuiz 3\n\n\n7\n\n4\nTest 1\n\n\n8\n\n4\n\n\n\n9\n\n5\nQuiz 4 4\n\n\n10\n\n5\n\n\n\n11\n\nTest 2",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#references",
    "href": "index.html#references",
    "title": "MA32011",
    "section": "References",
    "text": "References\n\n\n\n\nMurray, J. D. 2002. Mathematical Biology i: An Introduction. Springer.\n\n\nStrogatz, Steven H. 2001. Nonlinear Dynamics and Chaos: With Applications to Physics, Biology, Chemistry, and Engineering (Studies in Nonlinearity). Vol. 1. Westview press.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Introduction",
    "section": "",
    "text": "1.1 Discrete v continuous time\nThe goal of this module is to provide an introduction to dynamical systems. We will introduce key mathematical concepts and explore examples from physics and biology.\nTo begin with we introduce some key terminology.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#discrete-v-continuous-time",
    "href": "intro.html#discrete-v-continuous-time",
    "title": "1  Introduction",
    "section": "",
    "text": "1.1.1 Differential equations\nLet \\(t\\) be a continuous variable and \\(x=x(t)\\). \\(\\dot{x}\\) is used to denote the time derivative, i.e. \\[\n\\dot{x}:=\\frac{dx}{dt}.\n\\]\nSimilarly, the second order derivative is represented by \\[\n\\ddot{x}:=\\frac{d^2x}{dt^2}.\n\\]\n\n1.1.1.1 Population dynamics\nMany of the biological examples that we will encounter later describe population dynamics. Let \\(N(t)\\) represent the size of a population at time \\(t\\).\nSuppose that individuals are born at per capita constant rate \\(b\\) and die at a rate \\(d\\).\nWe can write \\[\nN(t+\\Delta t)=N(t)+bN(t)\\Delta t -dN(t)\\Delta t\n\\]\nGathering terms and taking the limit \\(\\Delta t \\rightarrow 0\\) yields \\[\n\\dot{N}=(b-d)N.\n\\]\nIf we allow the birth and death rates to depend on population size then we can derive a more general equation \\[\n\\dot{N}=H(N),\n\\] where \\(H\\) is some prescribed function. An example is the logistic growth equation \\[\n\\dot{N}=rN(1-N).\n\\tag{1.1}\\]\n\n\n1.1.1.2 Newton’s second law\nMany of the physics examples that we will examine later originate from Newton’s Second Law, i.e.\n\\[\nm\\ddot{x}=F(x,\\dot{x}),\n\\] where \\(x(t)\\) represents the position of a particle at time, \\(t\\), \\(m\\) represents a constant particle mass and \\(F\\) a resultant force.\nConsider the case in which \\(F\\) represents a linear restoring force, i.e. \\[\nF(x,\\dot{x})=-kx.\n\\] The equation of motion can be written as \\[\n\\ddot{x}=-\\mu x,\n\\tag{1.2}\\] where \\(\\mu=-k/m\\).\n\nExample 1.1 The app encodes a numerical solution of the second order ODE\n\\[\na\\ddot{x}+b\\dot{x}+cx=0.\n\\]\nUse the app to:\n\nidentify appropriate values of the parameters \\(a\\), \\(b\\) and \\(c\\) so that the solution captures the case of a particle of mass (\\(m\\)) equal to 3 subjected to a linear restoring force with spring constant (\\(k\\)) equal to 5.\nexplore the dependence of oscillation period on initial conditions.\n\nIs the behaviour of the numerical solution consistent with Equation 1.2?\n\n\n\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [viewer]\n#| viewerHeight: 800\n\nfrom shiny import App, Inputs, Outputs, Session, render, ui\nfrom shiny import reactive\n\nimport numpy as np\nfrom pathlib import Path\nimport matplotlib.pyplot as plt\nfrom scipy.integrate import odeint\n\napp_ui = ui.page_fluid(\n    ui.input_slider(id=\"a\",label=\"a\",min=0.01,max=3,value=0.1,step=0.001),\n    ui.input_slider(id=\"b\",label=\"b\",min=0.0,max=15.0,value=10.0,step=0.1),             \n    ui.input_slider(id=\"c\",label=\"c\",min=0.0,max=30.0,value=5.0,step=1.0),   \n    ui.input_slider(id=\"y0\",label=\"x(t=0)\",min=0.0,max=20.0,value=5.0,step=1.0),\n    ui.input_slider(id=\"y0p\",label=\"dx/dt(t=0)\",min=0.0,max=20.0,value=1,step=1.0),\n    ui.input_slider(id=\"T\",label=\"Simulation time\",min=0.0,max=60.0,value=20.0,step=0.5),\n        ui.output_plot(\"plot\"),\n)\n\ndef server(input, output, session):\n    \n    @render.plot\n    def plot():\n        fig, ax = plt.subplots()\n        #ax.set_ylim([-2, 2])\n        # Filter fata\n        \n        \n        a=float(input.a())\n        b=float(input.b())\n        c=float(input.c())\n        y_0=float(input.y0())\n        y_0_p=float(input.y0p())\n        T=float(input.T())\n        \n\n        \n        # Define rhs of LV ODEs\n        def rhs_pop_model(y,t,a,b,c):\n          rhs=np.zeros_like(y,dtype=float)\n\n          z=y[1]\n\n          #ay'' + by'+cy=0\n          # y'=z\n          # z'=y''=-(by'+cy)/a\n\n\n          dy_dt=y[1]\n          dz_dt=-(b*z+c*y[0])/a\n\n          rhs[0]=dy_dt\n          rhs[1]=dz_dt\n\n          return rhs\n\n        # Define discretised t domain\n        t = np.linspace(0, T, 1000)\n\n        # define initial conditions\n        init_cond=[y_0,y_0_p]\n        \n        # Compute numerical solution of ODEs\n        sol1 = odeint(rhs_pop_model, init_cond,t,args=(a,b,c))\n\n        # Plot results\n        y=sol1[:,0]\n        yp=sol1[:,1]\n        \n        \n        ax.plot(t, y)\n        ax.set_xlabel('$t$')\n        ax.set_ylabel('$x(t)$')\n\n        plt.grid()\n        #plt.show()\n    \napp = App(app_ui, server)\n\n\nFigure 1.1: Exploring numerical solutions of a linear second order ODE.\n\n\n\n\n\n1.1.2 Difference equations\nSuppose that \\(n\\) is a discrete variable. Let \\(y_n\\) represent a dependent variable at iteration \\(n\\). Consider the difference equation \\[\ny_{n+1}=ry_n(1-y_n),\n\\] where \\(r\\in \\Re\\).\n\nExample 1.2 Use the app below to 1. explore how the solution behaviour (top row) changes qualitatively as the parameter \\(r\\) increases. 2. connect the branching structure in the bifurcation diagram (second and third rows) to the qualitative behaviour of the solution (top row). 3. demonstrate self similarity (by zooming in on the bifurcation diagram (bottom row) show that the structure appears to repeat at finer scales).\n\n\n\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| viewerHeight: 800\n\n\n\n\nfrom shiny import App, Inputs, Outputs, Session, render, ui\nfrom shiny import reactive\n\nimport numpy as np\nfrom pathlib import Path\nimport matplotlib.pyplot as plt\nfrom scipy.integrate import odeint\n\napp_ui = ui.page_fluid(\n                 \n    ui.input_slider(id=\"u0\",label=\"u_0\",min=0.0,max=1.0,value=0.5,step=0.01),\n    ui.input_slider(id=\"T\",label=\"Number of iterations\",min=0.0,max=60.0,value=20.0,step=1.0),\n    ui.input_slider(id=\"r_range\",label=\"r zoomed\",min=0.0,max=4.0,value=[0.0,4.0],step=0.001),\n    ui.input_slider(id=\"u_range\",label=\"u zoomed\",min=0.0,max=1.0,value=[0.0,1.0],step=0.01),ui.output_plot(\"plot\"),\n    ui.input_slider(id=\"r\",label=\"r\",min=0.0,max=5.0,value=0.1,step=0.001),\n)\n\ndef server(input, output, session):\n    @output\n    @render.plot\n    def plot():\n        fig, ax = plt.subplots(3,1,figsize=(12, 4))\n        #ax.set_ylim([-2, 2])\n        # Filter fata\n        \n        \n        r=float(input.r())\n        u0=float(input.u0())\n        T=int(input.T())\n        r_min=float(input.r_range()[0])\n        r_max=float(input.r_range()[1])\n        u_min=float(input.u_range()[0])\n        u_max=float(input.u_range()[1])\n\n\n        # Define rhs of logistic map \n        def logistic_map(y,t,r):\n          rhs=r*y*(1-y)\n          return rhs\n        \n        def DiscreteSol(rhs_pop_model,y_0,t,r):\n            y=np.zeros_like(t,dtype=float)\n            y[0]=y_0\n            for i in t:\n                if i&gt;0:\n\n                    y[i]=rhs_pop_model(y[i-1],t[i],r)\n            return y\n\n        # Define discretised t domain\n        t = np.arange(0, T, 1)\n        # define initial conditions\n        init_cond=u0\n        \n        # Compute numerical solution of ODEs\n        sol1 = DiscreteSol(logistic_map,init_cond,t,r)\n\n        # Plot results\n        y=sol1\n        \n        ax[0].plot(t,y)\n        ax[0].set_xlabel('$n$')\n        ax[0].set_ylabel('$y_n$')\n        ax[0].set_ylim([-0.05,1.05])\n\n        plt.grid()\n\n        # Parameters\n        n_iterations = 1000  # total iterations for each value of r\n        n_last = 100         # number of iterations to plot (for steady state)\n        r_values = np.linspace(0.0, 4.0, 10000)  # range of r values\n        u0 = 0.5  # initial population (seed)\n\n        delta=0.25\n        #r_min=r-delta\n        #r_max=r+delta\n\n        r_values2 = np.linspace(r_min, r_max, 10000)  # range of r values\n\n        # Initialize plot\n        x = np.full_like(r_values, u0)\n        x2 = np.full_like(r_values2, u0)\n\n        # Iterate and plot bifurcation diagram\n         \n        for _ in range(n_iterations):\n            x = r_values * x * (1 - x)  # logistic map function\n            x2 = r_values2 * x2 * (1 - x2)  # logistic map function\n\n            if _ &gt;= (n_iterations - n_last):  # plot only steady state\n                ax[1].plot(r_values, x, ',k', alpha=0.25)\n                ax[1].plot([r,r],[0,1],'r--')\n                ax[2].plot(r_values2, x2, ',k', alpha=0.25)\n                ax[2].plot([r,r],[0,1],'r--')\n\n            # Labels and display\n            ax[1].set_title(\"Bifurcation Diagram\")\n            ax[1].set_xlabel(\"$r$\")\n            ax[1].set_ylabel(\"$y^*$\")\n            ax[2].set_title(\"Bifurcation Diagram (zoomed in) \")\n            ax[2].set_xlabel(\"$r$\")\n            ax[2].set_ylabel(\"$y^*$\")\n            ax[2].set_xlim([r_min,r_max])\n            ax[2].set_ylim([u_min,u_max])\n\n\n\n        plt.show()\n    \napp = App(app_ui, server)\n\n\nFigure 1.2: Exploring behaviour of the logistic map using numerical solutions and bifurcation diagrams.\n\n\n\n\n1.1.3 Key questions to ask of a dynamical system\n\ndo solutions exist? If so are they unique?\nIs there an explicit solution?\nCan we qualitatively describe solution behaviour?\nHow do the solutions depend on the model parameters?\nAre their critical values of parameters where solution behaviour changes?",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#autonomous-v-nonautonomous-odes",
    "href": "intro.html#autonomous-v-nonautonomous-odes",
    "title": "1  Introduction",
    "section": "1.2 Autonomous v nonautonomous ODEs",
    "text": "1.2 Autonomous v nonautonomous ODEs\nFor an autonomous system, the update does not explicitly depend on the independent variable. Equation 1.1 is autonomous. But \\[\n\\dot{x}=rx(1-x+t)\n\\] is nonautonomous (because of the explicit time dependence on the right-hand side).",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#linear-v-nonlinear",
    "href": "intro.html#linear-v-nonlinear",
    "title": "1  Introduction",
    "section": "1.3 Linear v Nonlinear",
    "text": "1.3 Linear v Nonlinear\nLinear systems satisfy a linear supposition principle: a sum of solutions is itself a solution. In general, this property does not hold for nonlinear systems.\nIn linear dynamical systems, the dynamics are a function of linear sums of the dependent variables. Hence\n\\[\n\\dot{x}=-x\n\\tag{1.3}\\] is a linear ordinary differential equation (ODE). But \\[\n\\dot{x}=-x^2\n\\tag{1.4}\\] is nonlinear.\n\nExample 1.3 Integrate each of Equation 1.3 and Equation 1.4. Use the solutions to demonstrate that the principle of linear superpositions holds for Equation 1.3 but not for Equation 1.4.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#quantitative-v-qualitative-solutions",
    "href": "intro.html#quantitative-v-qualitative-solutions",
    "title": "1  Introduction",
    "section": "1.4 Quantitative v qualitative solutions",
    "text": "1.4 Quantitative v qualitative solutions\nYou are likely used to solving problems in which an explicit solution can be found. For example, consider the ODE \\[\n\\dot{x}=-kx, \\quad  x(0)=x_0\n\\] where \\(k,x_0 \\in \\Re^+\\) .\nWe can integrate and express the solution as\n\\[\nx(t)=x_0e^{-kt}\n\\]\nUsing the explicit solution we can then answer questions about its behaviour. For example, let’s say we want to find the time, \\(t^*\\), at which the solution is half it’s maximum. Hence \\[\nx(t*)=x_0/2 \\implies t^* = \\frac{\\ln 2}{k}.\n\\]\nHowever, almost all problems that we will encounter in the study of nonlinear systems will not have an explicit solution. For example, consider the nonlinear ODE\n\\[\n\\dot{x}=-\\frac{k\\sin(x)+\\sqrt{x}}{1+x}, \\quad  x(0)=x_0,\n\\] where \\(0&lt;x_0&lt;\\pi\\).\nI cannot integrate this equation in order to find solutions in terms of standard functions. Hence I cannot quantitatively describe the solution. However, I can identify that\n\\[\n\\dot{x}&lt;0, \\  \\forall \\  0&lt;x&lt;\\pi.\n\\]\nHence the solution will decrease in value from the given initial condition and tend to zero as \\(t\\rightarrow \\infty\\). This is an example of a qualitative analysis.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#representing-solutions",
    "href": "intro.html#representing-solutions",
    "title": "1  Introduction",
    "section": "1.5 Representing solutions",
    "text": "1.5 Representing solutions\nIt is useful to define some important concepts that are used to describe the solutions of a dynamical system. Consider an ODE \\[\n\\dot{\\mathbf{x}}=\\mathbf{f}(\\mathbf{x}), \\quad \\mathbf{x}(0)=\\mathbf{x}_0,\n\\] where \\(\\mathbf{f}\\) is a prescribed function and \\(\\mathbf{x}_0\\) is an initial condition.\n\nphase space - a Cartesian coordinate system with dependent variables represented on Cartesian axes\nphase point - value of the solution at given time point\nvector field - the derivative of the solution, i.e. \\(\\mathbf{f}\\).\ntrajectory - a line in phase space that traces out a solution as time evolves (must be tangential to vector field)\nphase portrait - collection of trajectories (i.e. solutions with different initial conditions)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#fixed-points-and-their-stability",
    "href": "intro.html#fixed-points-and-their-stability",
    "title": "1  Introduction",
    "section": "1.6 Fixed points and their stability",
    "text": "1.6 Fixed points and their stability\nMany of the dynamical systems that we will study will be nonlinear. Hence it will not be possible to compute exact solutions.\nThe behaviour of dynamical systems can often be understood by considering the fixed points, i.e. values of the dependent variables at which the dynamics are at steady state.\nStability analyses are used to investigate the dynamics of perturbations about the steady state.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#uniqueness-and-existence",
    "href": "intro.html#uniqueness-and-existence",
    "title": "1  Introduction",
    "section": "1.7 Uniqueness and existence",
    "text": "1.7 Uniqueness and existence\nWe will restrict ourselves to problems in which the vector fields are sufficiently well behaved such that unique solutions exist.\n\nTheorem 1.1 TheoremSuppose that \\[\n\\dot{{x}}=f(x), \\quad x(0)=x_0.\n\\tag{1.5}\\]\nIf \\(f\\) is continuously differentiable on an open interval \\(D\\) of the \\(x\\) axis and \\(x_0\\) is a point in \\(D\\), Equation 1.5 possesses a unique solution on some time interval \\((-\\tau,\\tau)\\).\n\n\nHowever, it is noted that problems can be identified where solutions do not exist or where multiple solutions exist.\n\nExample 1.4 Show that the solution to the ODE \\[\n\\dot{x}=x^2 \\quad x(0)=2\n\\] blows up after a finite time.\nIs this result consistent with Theorem 1.1?\n\n\nExample 1.5 Show that the solution to the ODE \\[\n\\dot{x}=\\sqrt{x}, \\quad x(0)=0\n\\] is given by \\[\nx=\\begin{cases}\n&0, \\ \\ t\\leq\\delta \\\\\n&\\frac{(t-\\delta)^2}{4}&gt;\\delta, \\  \\ t&gt; \\delta\n\\end{cases}\n\\] for any \\(\\delta &gt;0\\). Why does this form imply that the solution is not unique? Is this result consistent with Theorem 1.1?",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#nondimensionalisation",
    "href": "intro.html#nondimensionalisation",
    "title": "1  Introduction",
    "section": "1.8 Nondimensionalisation",
    "text": "1.8 Nondimensionalisation\nIn real world problems, variables and parameters typically have units (e.g. time - seconds, Force - Newtons etc.). We can nondimensionalise problems by defining rescaled variables. This process can be used to justify simplifications to models and to reduce the number of parameters.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#numerical-solutions",
    "href": "intro.html#numerical-solutions",
    "title": "1  Introduction",
    "section": "1.9 Numerical solutions",
    "text": "1.9 Numerical solutions\nNumerical solutions are used to numerically compute approximate solutions to problems. The simplest example of a numerical method in a dynamical system is the forward Euler method. Suppose we want to study the ODE\n\\[\n\\dot{x}=f(x), \\quad x(0)=x_0, \\quad 0&lt;t&lt;T.\n\\]\nDiscretise the independent variable \\(t\\) by defining \\(t=0\\),\\(\\Delta t\\),\\(2\\Delta t\\),…,\\(T=N\\Delta T\\).\nApproximate the time derivative\n\\[\n\\dot{x}=\\frac{dx}{dt}\\sim \\frac{x(t+\\Delta t)-x(t)}{\\Delta t}\n\\]\nHence the solution at time \\(t+\\Delta t\\) can be approximated by \\[\nx(t+\\Delta t)=x(t)+\\Delta t f(x(t)).\n\\]\nGiven an initial condition \\(x(0)=a\\) we can compute the approximate solution at time \\(\\Delta t\\). Further iteration then allows an approximate solution to be calculated.\nNumerical solutions provide a a very useful way to explore solution behaviour. However, they describe the quantitative behaviour of a solution for a particular initial condition and set of parameter values.\n\nExample 1.6 The app below uses the Forward Euler method to compute numerical solutions of the ODE \\[\n\\dot{x}=a+bx+cx^2\n\\] in the domain \\([0,T]\\) with initial condition \\[\nx(0)=x_0.\n\\]\n\nChoose model parameters so that the app solves the ODE \\[\n\\dot{x}=-bx, \\quad x(0)=x_0.\n\\] and show that the numerical solution agrees (eye ball norm) with the exact solution (dashed line).\nShow that the numerical error increases with \\(\\Delta t\\).\n\n\n\n\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| viewerHeight: 800\n\n\n\n\nfrom shiny import App, Inputs, Outputs, Session, render, ui\nfrom shiny import reactive\n\nimport numpy as np\nfrom pathlib import Path\nimport matplotlib.pyplot as plt\nfrom scipy.integrate import odeint\n\napp_ui = ui.page_fluid(\n                 \n    ui.input_slider(id=\"x0\",label=\"x_0\",min=0.0,max=10.0,value=0.5,step=0.01),\n    ui.input_slider(id=\"T\",label=\"T\",min=0.0,max=60.0,value=20.0,step=1.0),\n    ui.input_slider(id=\"a\",label=\"a\",min=-5.0,max=5.0,value=-1.0,step=0.01),\n    ui.input_slider(id=\"b\",label=\"b\",min=-5.0,max=5.0,value=2.0,step=0.01),ui.output_plot(\"plot\"),\n    ui.input_slider(id=\"c\",label=\"c\",min=-5.0,max=5.0,value=0.1,step=0.01),\n    ui.input_slider(id=\"dt\",label=\"dt\",min=0.0,max=1.0,value=0.01,step=0.001),\n)\n\ndef server(input, output, session):\n    @output\n    @render.plot\n    def plot():\n        fig, ax = plt.subplots(1,1,figsize=(12, 4))\n       \n        x0=float(input.x0())\n        T=float(input.T())\n        a=float(input.a())\n        b=float(input.b())\n        c=float(input.c())\n        dt=float(input.dt())\n\n\n        # Define rhs of logistic map \n        def oderhs(y,a,b,c):\n          rhs=a+b*y+c*y**2\n          return rhs\n        \n        def FESol(y_0,t,a,b,c,dt):\n            y=np.zeros_like(t,dtype=float)\n            y[0]=y_0\n            for i in range(len(t)):\n                if i&gt;0:\n                    y[i]=y[i-1]+dt*oderhs(y[i-1],a,b,c)\n            return y\n\n        N=int(np.ceil(T/dt))\n        # Define discretised t domain\n        t = np.linspace(0, T,N)\n        \n        # Compute numerical solution of ODEs\n        sol1 = FESol(x0,t,a,b,c,dt)\n\n        # Plot results\n        y=sol1\n        \n        model_sol=x0*np.exp(b*t)\n        ax.plot(t,y,t,model_sol,'--')\n        ax.set_xlabel('$t$')\n        ax.set_ylabel('$x(t)$')\n        ax.set_ylim([0,2*x0])\n\n        fig.legend(['Num','$x_0e^{bt}$'])\n\n        plt.grid()\n\n        plt.show()\n    \napp = App(app_ui, server)\n\n\nFigure 1.3: Numerical solution of an ODE with a quadratic right-hand side.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "1DFlows.html",
    "href": "1DFlows.html",
    "title": "2  Flows on the line",
    "section": "",
    "text": "2.1 Geometric\nHere we consider ODE models with a single dependent variable that are first order in time.\nLet \\(x=x(t)\\) and consider the ODE \\[\n\\dot{x}=f(x).\n\\tag{2.1}\\]\nIt is assumed that \\(f\\) is smooth and real valued.\nFor many problems an explicit solution can either not be constructed or is not of practical use.\nAfter applying separation of variables, an implicit solution is given by\n\\[\nt=-\\ln |\\csc x + \\cot x| + C,\n\\] where \\(C\\) is an integration constant.\nHowever, this does not help me to describe the limiting behaviour of the solution as \\(t\\rightarrow \\infty\\).\nInstead let’s use a graphical method. In Figure 2.1 we sketch a graph of \\(f\\), the right-hand side of the ODE. The arrows depict the vector field. Hence when \\(f&gt;0\\), \\(\\dot{x}&gt;0\\) and the solution increases. In contrast, when \\(f&lt;0\\), \\(\\dot{x}&lt;0\\) and the solution decreases.\nNote that \\(f&gt;0  \\ \\forall \\ 0&lt;x&lt;\\pi\\). Hence for the initial condition \\(x_0=\\pi/4\\), \\(\\dot{x}_{t=0}&gt;0\\). The solution will increase until it reaches \\(\\pi\\). At \\(x=\\pi\\), \\(f=0\\).",
    "crumbs": [
      "1D flows",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Flows on the line</span>"
    ]
  },
  {
    "objectID": "1DFlows.html#geometric",
    "href": "1DFlows.html#geometric",
    "title": "2  Flows on the line",
    "section": "",
    "text": "Example 2.1 Let \\(x(t)\\). Consider the ODE \\[\n\\dot{x}=\\sin x.\n\\]\nFor the initial condition \\(x(0)=\\pi/4\\), describe solution behaviour as \\(t\\rightarrow \\infty\\).\n\n\n\n\n\n\n\nCode\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nx=np.linspace(-5,5)\n\ny=np.sin(x)\n\nfig,ax=plt.subplots()\n\nax.plot(x,y)\nax.set_xlabel('$x$')\nax.set_ylabel('$\\dot{x}$')\n# Arrow target (arrow head)\nx=[np.pi, np.pi, -np.pi, -np.pi]\ny=[0.0, 0.0,0.0,0.0]\n\n# Arrow start\nx0=[0.0,2.0*np.pi,0.0,-2.0*np.pi]\ny0 = [0.0,0.0,0.0,0.0]\n\n\nfor x_i,y_i,x0_i,y0_i in zip(x,y,x0,y0):\n  ax.annotate('',\n      xy=(x_i, y_i),        # arrow head\n      xytext=(x0_i, y0_i),  # arrow tail\n      arrowprops=dict(\n          arrowstyle='-&gt;',\n          color='black'\n      ),\n      ha='center'\n  )\n  \nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.1",
    "crumbs": [
      "1D flows",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Flows on the line</span>"
    ]
  },
  {
    "objectID": "1DFlows.html#fixed-points-and-linear-stability",
    "href": "1DFlows.html#fixed-points-and-linear-stability",
    "title": "2  Flows on the line",
    "section": "2.2 Fixed points and linear stability",
    "text": "2.2 Fixed points and linear stability\n\n2.2.1 Fixed points\nLet \\(x=x^*\\) be a fixed point of Equation 2.1. At \\(x=x^*\\) \\[\n\\dot{x}=0 \\implies f(x^*)=0.\n\\]\nThere are a number of interpretations of \\(x^*\\):\n\nroots of \\(f\\) (algebraic)\nstagnation points of the flow (topological)\n\n\nCorollary 1Any trajectory initialised at a fixed point remains there for all \\(t\\).\n\n\n\nExample 2.2 Find all the fixed points of \\[\n\\dot{x}=x^2-1,\n\\tag{2.2}\\]\n\n\nSolutionThe fixed points are point, \\(x^*\\) defined such that \\[\n\\dot{x}=0 \\ \\implies \\ f(x^*)=0.\n\\]\nHence fixed points satisfy \\[\n{x^*}^2-1=0.\n\\]\nThe solutions are \\[\nx^*=\\pm 1.\n\\]\nSee Figure 2.2 for graphical solution.\n\n\n\nCode\nimport numpy as np\n\nx=np.linspace(-2,2)\n\ny=x**2-1\n\nfig,ax=plt.subplots()\n\nax.plot(x,y)\nax.set_xlabel('$x$')\nax.set_ylabel('$f$')\nax.grid(True)\nax.set_ylim([-2,3])\n\n\n# Arrow target (arrow head)\nx=[-1.0, -1.0, 2.0]\ny=[0.0, 0.0,0.0]\n\n# Arrow start\nx0=[-2.0,1.0,1.0]\ny0 = [0.0,0.0,0.0]\n\n\nfor x_i,y_i,x0_i,y0_i in zip(x,y,x0,y0):\n  ax.annotate('',\n      xy=(x_i, y_i),        # arrow head\n      xytext=(x0_i, y0_i),  # arrow tail\n      arrowprops=dict(\n          arrowstyle='-&gt;',\n          color='black'\n      ),\n      ha='center'\n  )\n  \n\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.2: Graphical solution of Equation 2.2.\n\n\n\n\n\n2.2.2 Linear stability analysis\nLet \\(x=x^*\\) be a fixed point of Equation 2.1.\n\n2.2.2.1 A change of dependent variable\nTo perform a linear stability analysis we make the change of variables \\[\nx(t)=x^*+\\hat{x}(t)\n\\] where the new dependent variable, \\(\\hat{x}(t)\\), is a perturbation about the fixed point.\nThe time derivative on the left-hand side of Equation 2.1 transforms to \\[\n\\dot{x}= \\frac{d }{dt} (x^*) + \\frac{d }{dt}(\\hat{x}(t))=\\dot{\\hat{x}}.\n\\] Hence Equation 2.1 transforms to \\[\n\\dot{\\hat{x}} = f(x^*+\\hat{x}(t)).\n\\tag{2.3}\\]\n\n\n2.2.2.2 Taylor expansion and a linear system\nEmploying the Taylor expansion on the right-hand side of Equation 2.1 and making the assumption that perturbations are small \\[\n\\dot{\\hat{x}} = f(x^*)+  f'(x^*)\\hat{x}(t) + f''(x^*)\\hat{x}^2(t) + h.o.t.\n\\] Noting that\n\\[\nf(x^*)=0\n\\] and retaining linear terms yields \\[\n\\dot{\\hat{x}} =  f'(x^*)\\hat{x}(t)\n\\] with solution \\[\n\\hat{x}(t)=  \\eta e^{f'(x^*) t}.\n\\] Here \\(\\eta\\) is an initial perturbation about the steady-state that is determined by initial conditions.\n\n\n2.2.2.3 A condition for linear stability\nWhen \\(f'(x^*)&gt;0\\) the perturbation grows exponentially fast and the steady-state is linearly unstable. When \\(f'(x^*)&lt;0\\) the perturbation decays exponentially fast and the steady-state is linearly stable.\n\nExample 2.3 Determine the linear stability of the fixed points of \\[\n\\dot{x}=x^2-1.\n\\]\n\n\nExample 2.4 What can be said about the stability of the fixed points of the following ODEs:\n\n\\[\n\\dot{x}=-x^3.\n\\]\n\\[\n\\dot{x}=x^3.\n\\]\n\\[\n\\dot{x}=0.\n\\]",
    "crumbs": [
      "1D flows",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Flows on the line</span>"
    ]
  },
  {
    "objectID": "1DFlows.html#validity-of-linear-classification",
    "href": "1DFlows.html#validity-of-linear-classification",
    "title": "2  Flows on the line",
    "section": "2.3 Validity of linear classification",
    "text": "2.3 Validity of linear classification\nIt is worth highlighting here that\n\\[\nf'(x*)\n\\] can be interpreted as an eigenvalue of the linearised problem \\[\n\\dot{\\hat{x}}=\\lambda \\hat{x},\n\\] where \\[\n\\lambda = f'(x^*).\n\\]\n\nDefinition 2A fixed point is said to be hyperbolic when the eigenvalues of its linearisation are nonzero.\n\n\n\nTheorem 3: Hartman-GrobmanIf a system has a hyperbolic FP, the classification of the nonlinear system at the fixed point is determined by the linear classification.\n\n\nIf a fixed point is non-hypberbolic, it’s classification requires consideration of higher order terms.\n\nExample 2.5 Apply the Hartman Grobman theorem to the classification of the problem\n\\[\n\\dot{x}=-x^3.\n\\]",
    "crumbs": [
      "1D flows",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Flows on the line</span>"
    ]
  },
  {
    "objectID": "1DFlows.html#case-study-population-dynamics",
    "href": "1DFlows.html#case-study-population-dynamics",
    "title": "2  Flows on the line",
    "section": "2.4 Case study: population dynamics",
    "text": "2.4 Case study: population dynamics\nLet \\(N=N(t)\\). The logistic model of population growth, due to Verhulst, takes the form \\[\n\\dot{N}=rN(t)\\left (1-\\frac{N(t)}{K}\\right),\n\\tag{2.4}\\]\nwhere \\(r\\) is the linear growth rate and \\(K\\) is carrying capacity. We consider both \\(r,K\\in \\Re^+\\).\nQuestions to ask of such a model are: what type of biologically realistic solutions does it possess? Are there fixed points? If so, are they stable or unstable?\n\n2.4.0.1 Numerical solutions\nIn Figure 2.3 we present numerical solutions of equation using different initial conditions. Note the limiting behaviour of solutions as \\(t\\rightarrow \\infty\\). In Figure 2.3 it is clear that even though some solutions are initialised at \\(N_0=0.1\\), much closer to \\(N^*=0\\) than \\(N^*=K\\), they tend to the limit \\(N=K\\). Why do solutions not tend to \\(N^*=0\\)?\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport scipy\nfrom scipy.integrate import odeint\n# This codes computes a numerical solution of the logistic growth model\n\n\n# Define model parameters\nK=12\nr_1=0.22\nr_2=0.42\nr_3=0.72\n\n# Plotting parameter\nN_max=1.1\n\n# Initial condition\nn_0=1.5\n# Max time\nT=20\nt=np.linspace(0,T,100)\n\ndef rhslogistic_model(x,t,r,K):\n\n  rhs=r*x*(1-x/K)\n  return rhs\n\n# Numerically solve the ODE for different parameter values\nsol1=odeint(rhslogistic_model,n_0,t,args=(r_1,K))\nsol2=odeint(rhslogistic_model,n_0,t,args=(r_2,K))\nsol3=odeint(rhslogistic_model,n_0,t,args=(r_3,K))\n\n\n# Plot solutions\nfig, ax = plt.subplots(1)\n\nax.plot(t, sol1,t, sol2,t, sol3)\nplt.xlabel('$t$')\nplt.ylabel('$N$')\nplt.grid(True)\nplt.legend(['r='+str(r_1),'r='+str(r_2),'r='+str(r_3)])\nplt.show()\n\n\n\n\n\n\n\n\nFigure 2.3: Numerical solution of the logistic growth model\n\n\n\n\n\n\n\n2.4.0.2 Dimensional analysis and nondimensionalisation\n\\(N\\) represents the population density and has units of one over area (say \\(1/m^2\\)) and \\(t\\) has units of time (say, seconds, \\(s\\)). Hence the left-hand side of Equation 2.4 has units of \\(1/(m^2 s)\\). The first term on the right-hand side of Equation 2.4 is \\(rN\\). \\(N\\) has units \\(1/m^2\\) hence the parameter \\(r\\) must have units of \\(1/s\\) for dimensional consistency. This is consistent as \\(r\\) represents the linear growth rate.\nThe second term has the form \\(rN^2/K\\). Given the chosen units for \\(r\\) and \\(N\\), the parameter \\(K\\) must have dimensions \\(1/m^2\\). Again, this is consistent as \\(K\\) is a carrying capacity (i.e. it has units of population density).\nWe define the nondimensionalised variables \\[\nn=\\frac{N}{\\tilde{N}} \\ \\ \\ \\ \\ \\ \\tau=\\frac{t}{\\tilde{T}}\n\\] where \\(\\tilde{N}\\) and \\(\\tilde{T}\\) are constants that have units of population density and time, respectively. Hence Equation 2.4 transforms, upon change of variables, to \\[\n\\begin{aligned}\n\\frac{\\tilde{N}}{\\tilde{T} }\\frac{dn}{d\\tau}=r\\tilde{N}n(1-\\frac{n\\tilde{N}}{K}).\n\\end{aligned}\n\\]\nIn the case of the logistic equation there is only one time scale and density scale in the problem, hence we choose \\[\n\\tilde{T}=\\frac{1}{r}  \\ \\ \\ and \\ \\ \\ \\tilde{N}=K\n\\] and the dimensionless model is \\[\n\\begin{aligned}\n\\frac{dn}{d\\tau}= n(1-n)\n\\end{aligned}\n\\tag{2.5}\\] Note that we can retrieve the original equation by rescaling and calculating \\(N=\\tilde{N}n\\) and \\(t=\\tilde{T}\\tau\\).\n\n\n2.4.1 Fixed points and linear stability\nFixed points satisfy \\[\nn^*(1-n^*)=0.\n\\] Hence \\[\nn^*=0, \\ \\ \\ \\ n^*=1.\n\\]\nTo determine linear stability we compute \\[\nH'(n)= (1-2n).\n\\] When \\(n=n^*=0\\) we obtain \\[\nH'(n)= 1.\n\\] Hence the origin is a linearly unstable fixed point.\nAt the steady-state \\(n^*=1\\) \\[\nH'(n^*)= -1\n\\] hence \\(n^*=1\\) is linearly stable.\nNote that the linear stability analysis can explain the observations regarding the numeric solutions presented in Figure 2.3.\n\n\n2.4.2 Graphical analysis\nIn Figure 2.4 we plot the right-hand side of Equation 2.5. We can qualitatively describe model solutions by considering the arrow along the \\(n\\) axis. Suppose we consider an initial condition with \\(0&lt;n_0&lt;1\\). Using the graph of \\(H(n)\\), \\(dn/d\\tau\\) is positive, hence \\(n\\) increases as a function of time until \\(n(\\tau)\\rightarrow 1\\).\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\nN_max=2.1\nK=2\nr=0.2\nN_vec=np.linspace(0,N_max,100)\n\nrhs=r*N_vec*(1-N_vec/K)\nfig, ax = plt.subplots(1)\n\nax.plot(N_vec, rhs)\nplt.xlabel('$N$')\nplt.ylabel('$H(N)$')\nplt.show()\n\n\n\n\n\n\n\n\nFigure 2.4: Right-hand side of the logistic ODE\n\n\n\n\n\n\nExample 2.6 Use separation of variables to show that the solution can be written explicitly as \\[\nN(t)=\\frac{N_0K e^{rt}}{K+N_0(e^{rt}-1)}\n\\]\n\n\nSolution\\[\n\\int\\frac{ dN}{N(1-\\frac{N}{K})}=r\\int dt.\n\\] Using partial fractions \\[\n\\int\\frac{ dN}{N} + \\frac{1}{K}\\int\\frac{ dN}{1-\\frac{N}{K}}=r\\int dt.\n\\] Integration yields \\[\n\\ln N - \\ln\\left(1-\\frac{N}{K}\\right)= \\ln \\frac{N }{1-\\frac{N}{K}} =  rt+C.\n\\] Hence \\[\nN=\\frac{De^{rt}}{1+\\frac{D}{K}e^{rt}}\n\\] Given an initial condition \\(N(0)=N_0\\), we obtain \\[\nN(t)=\\frac{N_0K e^{rt}}{K+N_0(e^{rt}-1)}\n\\]\n\n\n\n2.4.2.1 Qualitative analysis of the exact solution\nAs \\(t\\rightarrow \\infty\\), \\(N\\rightarrow K\\). At \\(t=0\\), \\(N=N_0\\) and that for small \\(N_0\\ll K\\) the initial growth phase is exponential, i.e.  \\[\nN(t)\\sim N_0 e^{rt} \\\\ \\ \\ \\ \\ N_0\\ll K, t\\ll \\frac{1}{r}.\n\\]",
    "crumbs": [
      "1D flows",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Flows on the line</span>"
    ]
  },
  {
    "objectID": "1DFlows.html#impossibility-of-oscillations",
    "href": "1DFlows.html#impossibility-of-oscillations",
    "title": "2  Flows on the line",
    "section": "2.5 Impossibility of oscillations",
    "text": "2.5 Impossibility of oscillations\nIn 1D flows with well behaved \\(f\\), the range of permissible qualitiative behaviours is limited by the geometry of the line. Solutions must have one of the following behaviours:\n\ntend towards a stable fixed point\nmove away from an unstable fixed point\nstay at a fixed point for all time\ntend to \\(\\pm \\infty\\)\n\nOscillatory solutions to Equation 1.5 are impossible, i.e. first order autonomous ODEs (with one dependent variable) cannot oscillate.\nThis can be argued using geometrical constraints of dynamics on the line.\n\nExample 2.7 Consider the integral \\[\n\\int_t^{t+T} f(x(t))\\frac{dx}{dt}dt,\n\\] where \\(T\\) is the oscillation period. Use proof by contradiction to show that periodic solutions are impossible.\n\n\nSolutionSuppose that a periodic solution exists such that \\[\nx(t+T)=x(t), \\ \\ x(t+s)\\neq x(t+T) \\forall 0&lt;s&lt;T.\n\\]\nConsider \\[\n\\int_t^{t+T} f(x(t))\\frac{dx}{dt}dt.\n\\]\nThis integral can be written as \\[\n\\int_t^{t+T} f(x(t))^2 dt&gt;0,\n\\] as \\(f\\) is not identically zero.\nChanging variables yields \\[\n\\int_{x(t)}^{x(t+T)} f(x) dx =0.\n\\]\nHence there is a contradiction and no periodic solutions exist.",
    "crumbs": [
      "1D flows",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Flows on the line</span>"
    ]
  },
  {
    "objectID": "1DFlows.html#potential-flows",
    "href": "1DFlows.html#potential-flows",
    "title": "2  Flows on the line",
    "section": "2.6 Potential flows",
    "text": "2.6 Potential flows\nConsider the ODE \\[\n\\dot{x}=f(x).\n\\]\nSuppose that \\[\nf(x)=-\\frac{d V(x)}{dx}.\n\\]\nNow consider \\[\n\\dot{V}.\n\\] Applying the chain rule \\[\n\\dot{V}=\\frac{dV}{dx}\\dot{x}=-(\\frac{dV}{dx})^2\\leq 0.\n\\]\nHence for a potential flow \\(V\\) is never increasing. Hence particle move to points of lower potential until they reach equilibrium given by \\[\nf(x)=-\\frac{d V(x)}{dx}=0.\n\\]\n\nExample 2.8 Graph the potential for the system \\[\n\\dot{x}=-x\n\\] and identify equilibrium points.",
    "crumbs": [
      "1D flows",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Flows on the line</span>"
    ]
  },
  {
    "objectID": "Bifurcations.html",
    "href": "Bifurcations.html",
    "title": "3  Bifurcations",
    "section": "",
    "text": "3.1 Introduction\nThe qualitative behaviour of solutions of \\[\n\\dot{x}=f(x), \\quad  x(0)=x_0\n\\]\nare limited. Solutions either flow to a fixed point, remain at a fixed point or tend to \\(\\pm \\infty\\). So what is interesting about the study of such problems?\nNow we introduce the idea of bifurcations. These arise when the structure of the solutions (i.e. the number and/or stability of fixed points) changes at particular parameter values.\nAt a bifurcation point of a 1D system the eigenvalue is 0. Hence the fixed point is not hyperbolic.\nConsider the 1D system \\[\n\\dot{x}=f(x,r)\n\\] where \\(r\\) is a parameter.\nSuppose that\nUpon Taylor expansion of \\(f\\) about \\((x^*,r_c)\\), we obtain \\[\n\\dot{x}=f(x^*,r_c)+\\frac{\\partial f}{\\partial x}_{(x^*,r_c)}(x-x^*) + \\frac{\\partial f}{\\partial r}_{(x^*,r_c)}(r-r_c)\n+ \\frac{1}{2}(x-x_c)^2\\frac{\\partial^2 f}{\\partial x^2}_{(x^*,r_c)}  + ... \\]\nAs \\(x^*\\) is a fixed point\n\\[\n\\dot{x}= \\frac{\\partial f}{\\partial r}_{(x^*,r_c)}(r-r_c)\n+ \\frac{1}{2}(x-x^*)^2\\frac{\\partial^2 f}{\\partial x^2}_{(x^*,r_c)}  +\\frac{1}{2}(r-r_c)^2\\frac{\\partial^2 f}{\\partial r^2}_{(x^*,r_c)} +(r-r_c)(x-x^*)\\frac{\\partial^2 f}{\\partial r \\partial x}_{(x^*,r_c)}  ... \\]\nClose to a bifurcation point, the stability classification will be determined by the higher order derivatives of \\(f\\) w.r.t. \\(x\\) and \\(r\\).\nIt can be shown that generic bifurcations of the system \\[\n\\dot{x}=f(x,r), \\quad x(0)=x_0\n\\] can be reduced to one of three normal forms:",
    "crumbs": [
      "1D flows",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Bifurcations</span>"
    ]
  },
  {
    "objectID": "Bifurcations.html#introduction",
    "href": "Bifurcations.html#introduction",
    "title": "3  Bifurcations",
    "section": "",
    "text": "there is a fixed point \\(x=x^*\\).\nat some \\(r=r_c\\) the eigenvalue of the linearised system vanishes.\n\n\n\n\n\n\n\nsaddle node bifurcations\ntranscritical bifurcations\npitchfork bifurcations",
    "crumbs": [
      "1D flows",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Bifurcations</span>"
    ]
  },
  {
    "objectID": "Bifurcations.html#saddle-node",
    "href": "Bifurcations.html#saddle-node",
    "title": "3  Bifurcations",
    "section": "3.2 Saddle node",
    "text": "3.2 Saddle node\nAt a saddle node bifurcation, two fixed points move towards one another and mutually annihilate. The canonical form is given by\n\\[\n\\dot{x}=f(x,r)=r+x^2,\n\\tag{3.1}\\] where \\(r \\in \\Re\\).\n\nExample 3.1 Identify the fixed points of Equation 3.1 and determine their linear stability.\n\n\nSolutionThe fixed points are \\[\nx^*_{\\pm}=\\pm \\sqrt{-r}.\n\\]\nIn the case \\(r&lt;0\\)\n\\[\nf'(x^*)=\\pm 2\\sqrt{-r}.\n\\]\nHence \\(x^*_-\\) is linearly stable and \\(x^*_+\\) is linearly unstable.\nFor \\(r=0\\) the fixed point is half-stable and it vanishes for \\(r&gt;0\\). Upon plotting \\(x^*\\) against \\(r\\) we obtain a bifurcation diagram.\n\n\nIn Figure 3.1 we plot \\(f\\) at three different values of \\(r\\). Note that when \\(r&gt;0\\), \\(f&gt;0\\) and the solution is an increasing function of time.\nAt \\(r=0\\) there is a double root of \\(f\\). Here the fixed point is half stable. For the initial condition \\(x_0&lt;0\\) the solution will increase until \\(x(t=0)\\). It is stable to perturbations along the negative \\(x\\) axis. However, for \\(x_0&gt;0\\) \\(f&gt;0\\) and the solution is an increasing function of time. Hence the solution is unstable to perturbations with \\(x_0&gt;0\\). Hence the fixed point \\(x^*=0\\) is defined to be half-stable when \\(r=0\\).\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nx=np.linspace(-1.5,1.5)\n\nr_vec=[-1.0,0.0,1.0]\nfig,ax=plt.subplots(1,3,sharex=True, sharey=True)\nax=ax.flatten()\n\nfor i,r_i in enumerate(r_vec):\n    f=r_i+x**2\n    ax[i].plot(x,f)\n    r=r_i\n     # ---- fixed points ----\n    fixed_points = []\n    if r &lt;= 0:\n        fixed_points += [np.sqrt(-r), -np.sqrt(-r)]\n    \n    for x_fp in fixed_points:\n        df =  2 * x_fp   # derivative at fixed point\n        \n        if df &lt; 0:   # stable\n            ax[i].plot(x_fp, 0, 'ko', markersize=8)\n        else:        # unstable\n            ax[i].plot(x_fp, 0, 'ko', markerfacecolor='white', markersize=8)\n\n    ax[i].axhline(0, color='gray', lw=0.5)\n    ax[i].axvline(0, color='gray', lw=0.5)\n    ax[i].set_title(f\"r = {r}\")\n    ax[i].set_ylim([-2,2])\n\n    x_arrows = np.linspace(-1.8, 1.8, 6)\n    f_arrows = r+x_arrows**2\n\n    for xa, fa in zip(x_arrows, f_arrows):\n        if abs(fa) &lt; 1e-6:\n            continue\n        direction = np.sign(fa)\n        ax[i].arrow(\n            xa, 0,\n            0.12 * direction, 0,\n            head_width=0.08,\n            head_length=0.16,\n            fc='k', ec='k',\n            length_includes_head=True\n        )\n    fig.supxlabel('$x$')\n    fig.supylabel('$\\dot{x}$')\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3.1\n\n\n\nIn Figure 3.2 we plot the fixed points against the parameter \\(r\\). For \\(r&lt;0\\) there are two fixed points (\\(\\sqrt{r}\\) is linearly unstable whilst \\(-\\sqrt{r}\\) is linearly stable). Usually some annotation is used to denote the stability. For \\(r&gt;0\\) there are no fixed points.\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nr = np.linspace(-2, 2, 400)\n\n# fixed points\nx0 = np.zeros_like(r)\n\nx_plus = np.full_like(r, np.nan)\nx_minus = np.full_like(r, np.nan)\n\nmask = r &gt; 0\nx_plus[mask] = np.sqrt(r[mask])\nx_minus[mask] = -np.sqrt(r[mask])\n\nfig, ax = plt.subplots(figsize=(6, 5))\n\n# unstable branch x = 0 for r &gt; 0\n\n\n# stable branches ±sqrt(r)\nax.plot(-r, x_plus, 'k--', lw=2)\nax.plot(-r, x_minus, 'k-', lw=2)\n\nax.axhline(0, color='gray', lw=0.5)\nax.axvline(0, color='gray', lw=0.5)\n\nax.set_xlabel(\"$r$\")\nax.set_ylabel(\"$x*$\")\nax.set_xlim([-2,2])\n\n\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3.2\n\n\n\nWith the app below you can explore how the value of the parameter value \\(r\\) affects system dynamics.\nThe app computes solutions to \\[\n\\dot{x}=r+x^2, \\quad x(0)=x_0, \\quad t \\in[0,T].\n\\]\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| viewerHeight: 800\n#| label: fig-saddlenode\n\n\nfrom shiny import App, Inputs, Outputs, Session, render, ui\nfrom shiny import reactive\n\nimport numpy as np\nfrom pathlib import Path\nimport matplotlib.pyplot as plt\nfrom scipy.integrate import odeint\n\napp_ui = ui.page_fluid(\n                 \n    ui.input_slider(id=\"u0\",label=\"x_0 (Init. Cond.)\",min=-1.0,max=1.0,value=0.5,step=0.01),\n    ui.input_slider(id=\"T\",label=\"T (Time)\",min=0.1,max=60.0,value=20.0,step=1.0),\n    ui.input_slider(id=\"r\",label=\"r\",min=-1.0,max=1.0,value=0.1,step=0.01),\n    ui.output_plot(\"plot\"),\n\n)\n\ndef server(input, output, session):\n    @output\n    @render.plot\n    def plot():\n        fig, ax = plt.subplots(3,1,figsize=(12, 4))\n        #ax.set_ylim([-2, 2])\n        #         \n        r=float(input.r())\n        u0=float(input.u0())\n        T=int(input.T())\n\n        if r&gt;0:\n            T=1/np.sqrt(r)*(np.pi/2.0-np.arctan(u0/np.sqrt(r)))\n        elif (r&lt;0):\n            if u0&gt;np.sqrt(-r):\n                T=1/np.sqrt(-r)*(np.pi/2.0-np.arctan(u0/np.sqrt(-r)))\n        else:\n            T=1/u0\n        \n\n        # Define rhs of bfc ODE \n        def saddle_node_bfc_rhs(y,t,r):\n          rhs=r+y**2.0\n          return rhs\n        \n        def ODESol(saddle_node_bfc_rhs,y_0,t,r):\n            y=np.zeros_like(t,dtype=float)\n            init_cond=y_0\n\n            \n            sol1 = odeint(saddle_node_bfc_rhs, init_cond,t,args=(r,))\n            return sol1\n            \n        # Define discretised t domain\n        t = np.linspace(0, T)\n        # define initial conditions\n        init_cond=u0\n        \n        ax[0].set_xlabel('$t$')\n        ax[0].set_ylabel('$x(t)$')\n\n        plt.grid()\n        \n        # Compute numerical solution of ODEs\n        sol1 = ODESol(saddle_node_bfc_rhs,init_cond,t,r)\n\n        # Plot results\n        x=sol1\n        \n        ax[0].plot(t,x)\n        ax[0].set_xlabel('$t$')\n        ax[0].set_ylabel('$x$')\n        ax[0].set_ylim([-3,3])\n        ax[0].set_title('Numerical solution')\n\n        r_values = np.linspace(-2.0, 2.0, 1000)  # range of r values\n        \n        x=np.sqrt(r_values)\n\n        ax[1].plot(-r_values,x,'k--',-r_values,-x,'k')\n        ax[1].set_xlabel('$r$')\n        ax[1].set_ylabel('$x^*$')\n        ax[1].set_xlim([-3,3])\n        ax[1].set_title('Bifurcation diagram')\n        ax[1].plot([r,r],[-3,3],'--')\n\n\n        x_plot=np.linspace(-3,3)\n        f=saddle_node_bfc_rhs(x_plot,0,r)\n        ax[2].plot(x_plot,f)\n        ax[2].set_xlabel('$x$')\n        ax[2].set_ylabel('$f$')\n        ax[2].set_ylim([-2,2])\n        ax[2].plot([u0,u0],[-2,2],'--')\n\n        ax[2].set_title('Phase portrait')\n        \n\n\n        \napp = App(app_ui, server)\nAn app to exploring behaviour of the saddle-node bifurcation.\n\nExample 3.2 Consider the following ODE: \\[\n\\dot{x}=1+rx+x^2, \\quad x(0)=x_0.\n\\] in the case \\(r \\in \\Re^+\\).\n\nSketch the bifurcation diagram.\nShow that upon introducing rescaled variables, the ODE can be written in the normal form \\[\n\\dot{y}=r'+y^2.\n\\] Hint: try completing the square.",
    "crumbs": [
      "1D flows",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Bifurcations</span>"
    ]
  },
  {
    "objectID": "Bifurcations.html#transcritical",
    "href": "Bifurcations.html#transcritical",
    "title": "3  Bifurcations",
    "section": "3.3 Transcritical",
    "text": "3.3 Transcritical\nAt a transcritical bifurcation the stability of a fixed point changes as a parameter is varied. However, fixed points do not disappear, as was the case with the saddle node bifurcation.\nThe normal form for a transcritical bifurcation is\n\\[\n\\dot{x}=rx-x^2,\n\\]\n\nExample 3.3 Identify the fixed points and their linear stability\n\n\nSolutionThe fixed points are \\(x^*=0\\) and \\(x^*=r\\). For \\(r&lt;0\\), \\(x^*=r\\) is linearly unstable and \\(x^*=0\\) is linearly stable. At \\(r=0\\) the fixed points coalesce and the fixed point is half stable. For \\(r&gt;0\\) \\(x^*=0\\) is linearly unstable and \\(x^*=r\\) is linearly stable.\n\n\nIn Figure 3.3 the function \\(f\\) is plotted for different values of the parameter \\(r\\). The origin is always a fixed point. For \\(r&lt;0\\) there is a fixed point on the negative real axis whilst for \\(r&gt;0\\) there is a fixed point on the positive real axis. Hence the number of fixed points is two for \\(|r|&gt;0\\). This bifurcation is fundamentally different to the saddle node bifurcation (where there are no fixed points on one side of the bifurcation).\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nx=np.linspace(-1.5,1.5)\n\nr_vec=[-1.0,0.0,1.0]\nfig,ax=plt.subplots(1,3,sharex=True, sharey=True)\nax=ax.flatten()\n\nfor i,r_i in enumerate(r_vec):\n    f=r_i*x-x**2\n    ax[i].plot(x,f)\n    r=r_i\n     # ---- fixed points ----\n    fixed_points = [0.0]\n    if r &gt; 0:\n        fixed_points += [0,r]\n    elif r&lt;0:\n        fixed_points += [r,0]\n\n    \n    for x_fp in fixed_points:\n        df = r - 2 * x_fp   # derivative at fixed point\n        \n        if df &lt; 0:   # stable\n            ax[i].plot(x_fp, 0, 'ko', markersize=8)\n        else:        # unstable\n            ax[i].plot(x_fp, 0, 'ko', markerfacecolor='white', markersize=8)\n\n    ax[i].axhline(0, color='gray', lw=0.5)\n    ax[i].axvline(0, color='gray', lw=0.5)\n    ax[i].set_title(f\"r = {r}\")\n    ax[i].set_ylim([-2,2])\n\n    x_arrows = np.linspace(-1.8, 1.8, 6)\n    f_arrows = r * x_arrows - x_arrows**2\n\n    for xa, fa in zip(x_arrows, f_arrows):\n        if abs(fa) &lt; 1e-3:\n            continue\n        direction = np.sign(fa)\n        ax[i].arrow(\n            xa, 0,\n            0.12 * direction, 0,\n            head_width=0.08,\n            head_length=0.08,\n            fc='k', ec='k',\n            length_includes_head=True\n        )\n    fig.supxlabel('$x$')\n    fig.supylabel('$\\dot{x}$')\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3.3\n\n\n\nIn Figure 3.4 we plot a bifurcation diagram for the transcritical bifurcation. Note that \\(x^*=0\\) is always a fixed points but it’s stability changes at \\(r=0\\).\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nr = np.linspace(-2, 2, 400)\n\n# fixed points\nx0 = np.zeros_like(r)\n\nx_plus = np.full_like(r, np.nan)\nx_minus = np.full_like(r, np.nan)\n\nmask = r &gt;= 0\nx_plus[mask] = (r[mask])\nx_minus[mask] = (r[mask])\n\nfig, ax = plt.subplots(figsize=(6, 5))\n\n# unstable branch x = 0 for r &gt; 0\nax.plot(r[r &gt; 0], x0[r &gt; 0], 'k--', lw=2)\nax.plot(r[r &lt; 0], r[r &lt; 0], 'k--', lw=2)\n\n# stable branch x = 0 for r &lt; 0\nax.plot(r[r &lt; 0], x0[r &lt; 0], 'k-', lw=2)\n\n# stable branches ±sqrt(r)\nax.plot(r, x_plus, 'k-', lw=2)\nax.plot(r, x_minus, 'k-', lw=2)\n\nax.axhline(0, color='gray', lw=0.5)\nax.axvline(0, color='gray', lw=0.5)\n\nax.set_xlabel(\"$r$\")\nax.set_ylabel(\"$x*$\")\n\n\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3.4\n\n\n\nWith the app below you can explore how the value of the parameter value \\(r\\) affects system dynamics for the transcritical bifurcation.\nThe app computes solutions to \\[\n\\dot{x}=rx-x^2, \\quad x(0)=x_0, \\quad t \\in[0,T].\n\\]\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| viewerHeight: 800\n#| label: fig-transcrit\n\n\nfrom shiny import App, Inputs, Outputs, Session, render, ui\nfrom shiny import reactive\n\nimport numpy as np\nfrom pathlib import Path\nimport matplotlib.pyplot as plt\nfrom scipy.integrate import odeint\nfrom scipy.integrate import solve_ivp\n\napp_ui = ui.page_fluid(\n                 \n    ui.input_slider(id=\"u0\",label=\"x_0 (Init. Cond.)\",min=-3.0,max=3.0,value=0.5,step=0.01),\n    ui.input_slider(id=\"T\",label=\"T (Time)\",min=0.1,max=60.0,value=20.0,step=1.0),\n    ui.input_slider(id=\"r\",label=\"r\",min=-2.0,max=2.0,value=0.1,step=0.1),\n    ui.output_plot(\"plot\"),\n\n)\n\ndef server(input, output, session):\n    @output\n    @render.plot\n    def plot():\n        fig, ax = plt.subplots(3,1,figsize=(12, 4))\n        #ax.set_ylim([-2, 2])\n        #         \n        r=float(input.r())\n        u0=float(input.u0())\n        T=int(input.T())\n    \n        \n        # Define rhs of bfc ODE \n        def saddle_node_bfc_rhs(t,y,r):\n          rhs=r*y-y**2\n          return rhs\n        def stop_event(t, y,r):\n            return np.abs(y[0]-10)          # trigger when y[0] == 0\n\n        \n        def ODESol(saddle_node_bfc_rhs,y_0,T,r):\n            #y=np.zeros_like(t,dtype=float)\n            init_cond=y_0\n\n            stop_event.terminal = True   # STOP integration\n            stop_event.direction = 1   # only trigger when crossing downward\n\n            sol1 = solve_ivp(saddle_node_bfc_rhs,t_span=(0, T),y0=[init_cond],\n                events=stop_event,args=(r,)\n            )\n            return sol1\n            \n        # Define discretised t domain\n        # define initial conditions\n        init_cond=u0\n        \n        ax[0].set_xlabel('$t$')\n        ax[0].set_ylabel('$x(t)$')\n\n        plt.grid()\n        \n        # Compute numerical solution of ODEs\n        sol1 = ODESol(saddle_node_bfc_rhs,init_cond,T,r)\n        \n        ax[0].plot(sol1.t,sol1.y[0])\n        ax[0].set_xlabel('$t$')\n        ax[0].set_ylabel('$x$')\n        ax[0].set_ylim([-10,10])\n        ax[0].set_title('Numerical solution')\n\n        \n        r_values = np.linspace(-2.0, 2.0, 1000)  # range of r values\n        \n        x_1=np.zeros_like(r_values)\n        x_2=r_values\n\n        ax[1].plot(r_values[r_values&lt;0],x_1[r_values&lt;0],'k',r_values[r_values&lt;0],x_2[r_values&lt;0],'k--')\n        ax[1].plot(r_values[r_values&gt;0],x_1[r_values&gt;0],'k--',r_values[r_values&gt;0],x_2[r_values&gt;0],'k')\n        ax[1].set_xlabel('$r$')\n        ax[1].set_ylabel('$x^*$')\n        ax[1].set_xlim([-3,3])\n        ax[1].set_title('Bifurcation diagram')\n        ax[1].plot([r,r],[-3,3],'--')\n\n        \n        x_plot=np.linspace(-3,3)\n        f=saddle_node_bfc_rhs(0,x_plot,r)\n        ax[2].plot(x_plot,f)\n        ax[2].set_xlabel('$x$')\n        ax[2].set_ylabel('$f$')\n        ax[2].set_ylim([-2,2])\n        ax[2].plot([u0,u0],[-2,2],'--')\n\n        ax[2].set_title('Phase portrait')\n\n        x_arrows = np.linspace(-1.8, 1.8, 6)\n        f_arrows = r * x_arrows - x_arrows**2\n\n        for xa, fa in zip(x_arrows, f_arrows):\n            if abs(fa) &lt; 1e-3:\n                continue\n            direction = np.sign(fa)\n            ax[2].arrow(\n                xa, 0,\n                0.12 * direction, 0,\n                head_width=0.2,\n                head_length=0.28,\n                fc='k', ec='k',\n                length_includes_head=True\n            )\n        \n                \napp = App(app_ui, server)\nAn app for exploring behaviour of the transcritical bifurcation.\n\n\nExample 3.4 Sketch the bifurcation diagram for\n\\[\n\\dot{x}=rx+x^2.\n\\]\n\n\nExample 3.5 Consider the ODE\n\\[\n\\dot{x}=r\\ln x + x-1.\n\\]\n\nShow that \\(x^*=1\\) is a fixed point.\nMake a change of variables \\(u=x-1\\) in order to analyse perturbations about the fixed point.\nUse a Taylor expansion to show that this system can be approximated by the transcritical normal form. Hence deduce that the bifurcation vaue is \\(r=-1\\).\nShow that the system can be reduced to the normal form \\[\n\\dot{X}=RX-X^2\n\\] by making an appropriate change of variables.",
    "crumbs": [
      "1D flows",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Bifurcations</span>"
    ]
  },
  {
    "objectID": "Bifurcations.html#pitchfork",
    "href": "Bifurcations.html#pitchfork",
    "title": "3  Bifurcations",
    "section": "3.4 Pitchfork",
    "text": "3.4 Pitchfork\nPitchfork bifurcations often arise in situations with symmetry. Typically, two or more fixed points appear/disappear together.\n\n3.4.1 Supercritical pitchfork\nThe normal form of the supercritical pitchfork bifurcation is \\[\n\\dot{x}=rx-x^3,\n\\]\n\nExample 3.6 Identify the fixed points and determine their linear stability\n\n\nSolutionThe fixed points satisfy \\[\nrx^*-{x^*}^3=0\n\\]\nHence \\(x^*\\) is a fixed point. Other fixed points satisfy \\[\nr-{x^*}^2=0\n\\]\nHence there is a pair of fixed points given by \\[\nx^*= \\pm \\sqrt{r},\n\\] defined for \\(r&gt;0\\).\nFor \\[\nf(x,r)=rx-x^3\n\\] differentiation yields \\[\nf'(x)=r-3x^2.\n\\]\nAt \\(x^*=0\\)\n\\[\nf'(0)=r.\n\\]\nFor \\(r&lt;0\\), \\(x^*=0\\) is linearly stable. For \\(r&gt;0\\), \\(x^*=0\\) is linearly unstable. There is a bifurcation at \\(r=0\\).\nAt \\(x^*= \\pm \\sqrt{r}\\)\n\\[\nf'(\\pm \\sqrt{r})=r-3r=-2r.\n\\]\nHence when real, non-trivial fixed points exist \\(r&gt;0\\) they are linearly stable.\nAt \\(r=0\\) the fixed points coalesce and the fixed point is half stable.\n\n\nIn Figure 3.5 we plot \\(f\\) for three different values of \\(r\\). For \\(r&lt;0\\) it is clear that \\(x^*=0\\) is a uniquye fixed point and that it is linearly stable. For \\(r&gt;0\\) \\(f\\) is a cubic with three real roots. Note that the non-zero roots are linearly stable and symmetrically distributed about the origin. We refer to a system with two linearly stable fixd points as being bistable.\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nx=np.linspace(-1.5,1.5)\n\nr_vec=[-1.0,0.0,1.0]\nfig,ax=plt.subplots(1,3,sharex=True, sharey=True)\nax=ax.flatten()\n\nfor i,r_i in enumerate(r_vec):\n    f=r_i*x-x**3\n    ax[i].plot(x,f)\n    r=r_i\n     # ---- fixed points ----\n    fixed_points = [0.0]\n    if r &gt; 0:\n        fixed_points += [np.sqrt(r), -np.sqrt(r)]\n    \n    for x_fp in fixed_points:\n        df = r - 3 * x_fp**2   # derivative at fixed point\n        \n        if df &lt; 0:   # stable\n            ax[i].plot(x_fp, 0, 'ko', markersize=8)\n        else:        # unstable\n            ax[i].plot(x_fp, 0, 'ko', markerfacecolor='white', markersize=8)\n\n    ax[i].axhline(0, color='gray', lw=0.5)\n    ax[i].axvline(0, color='gray', lw=0.5)\n    ax[i].set_title(f\"r = {r}\")\n    ax[i].set_ylim([-2,2])\n\n    x_arrows = np.linspace(-1.8, 1.8, 6)\n    f_arrows = r * x_arrows - x_arrows**3\n\n    for xa, fa in zip(x_arrows, f_arrows):\n        if abs(fa) &lt; 1e-3:\n            continue\n        direction = np.sign(fa)\n        ax[i].arrow(\n            xa, 0,\n            0.12 * direction, 0,\n            head_width=0.08,\n            head_length=0.08,\n            fc='k', ec='k',\n            length_includes_head=True\n        )\n    fig.supxlabel('$x$')\n    fig.supylabel('$\\dot{x}$')\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3.5\n\n\n\nIn Figure 3.6 we plot a bifurcation diagram for the supercritical pitchfork. Note that when \\(r&lt;0\\) there is a single fixed point that is linearly stable. For \\(r&gt;0\\) there are three fixed points.\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nr = np.linspace(-2, 2, 400)\n\n# fixed points\nx0 = np.zeros_like(r)\n\nx_plus = np.full_like(r, np.nan)\nx_minus = np.full_like(r, np.nan)\n\nmask = r &gt;= 0\nx_plus[mask] = np.sqrt(r[mask])\nx_minus[mask] = -np.sqrt(r[mask])\n\nfig, ax = plt.subplots(figsize=(6, 5))\n\n# unstable branch x = 0 for r &gt; 0\nax.plot(r[r &gt; 0], x0[r &gt; 0], 'k--', lw=2)\n\n# stable branch x = 0 for r &lt; 0\nax.plot(r[r &lt; 0], x0[r &lt; 0], 'k-', lw=2)\n\n# stable branches ±sqrt(r)\nax.plot(r, x_plus, 'k-', lw=2)\nax.plot(r, x_minus, 'k-', lw=2)\n\nax.axhline(0, color='gray', lw=0.5)\nax.axvline(0, color='gray', lw=0.5)\n\nax.set_xlabel(\"$r$\")\nax.set_ylabel(\"$x*$\")\n\n\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3.6\n\n\n\nWith the app below you can explore how the value of the parameter value \\(r\\) affects system dynamics for the supercritical pitchfork bifurcation.\nThe app computes solutions to \\[\n\\dot{x}=rx-x^3, \\quad x(0)=x_0, \\quad t \\in[0,T].\n\\]\n\nShow that in the case where \\(r&gt;0\\) the initial conditions control which of the stable fixed points the system finds.\n\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| viewerHeight: 800\n#| label: fig-transcrit\n\n\nfrom shiny import App, Inputs, Outputs, Session, render, ui\nfrom shiny import reactive\n\nimport numpy as np\nfrom pathlib import Path\nimport matplotlib.pyplot as plt\nfrom scipy.integrate import odeint\nfrom scipy.integrate import solve_ivp\n\napp_ui = ui.page_fluid(\n                 \n    ui.input_slider(id=\"u0\",label=\"x_0 (Init. Cond.)\",min=-3.0,max=3.0,value=0.5,step=0.01),\n    ui.input_slider(id=\"T\",label=\"T (Time)\",min=0.1,max=60.0,value=20.0,step=1.0),\n    ui.input_slider(id=\"r\",label=\"r\",min=-2.0,max=2.0,value=0.1,step=0.1),\n    ui.output_plot(\"plot\"),\n\n)\n\ndef server(input, output, session):\n    @output\n    @render.plot\n    def plot():\n        fig, ax = plt.subplots(3,1,figsize=(12, 4))\n        #ax.set_ylim([-2, 2])\n        #         \n        r=float(input.r())\n        u0=float(input.u0())\n        T=int(input.T())\n    \n        \n        # Define rhs of bfc ODE \n        def super_pitchfork_bfc_rhs(t,y,r):\n          rhs=r*y-y**3\n          return rhs\n        def stop_event(t, y,r):\n            return np.abs(y[0]-10)          # trigger when y[0] == 0\n\n        \n        def ODESol(rhs,y_0,T,r):\n            #y=np.zeros_like(t,dtype=float)\n            init_cond=y_0\n\n            stop_event.terminal = True   # STOP integration\n            stop_event.direction = 1   # only trigger when crossing downward\n\n            sol1 = solve_ivp(rhs,t_span=(0, T),y0=[init_cond],\n                events=stop_event,args=(r,)\n            )\n            return sol1\n            \n        # Define discretised t domain\n        # define initial conditions\n        init_cond=u0\n        \n        ax[0].set_xlabel('$t$')\n        ax[0].set_ylabel('$x(t)$')\n\n        plt.grid()\n        \n        # Compute numerical solution of ODEs\n        sol1 = ODESol(super_pitchfork_bfc_rhs,init_cond,T,r)\n        \n        ax[0].plot(sol1.t,sol1.y[0])\n        ax[0].set_xlabel('$t$')\n        ax[0].set_ylabel('$x$')\n        ax[0].set_ylim([-2.5,2.5])\n        ax[0].set_title('Numerical solution')\n\n        \n        r_values = np.linspace(-2.0, 2.0, 1000)  # range of r values\n        r_values2 = np.linspace(0.0, 2.0, 1000)  # range of r values\n\n        \n        x_1=np.zeros_like(r_values)\n        x_2=np.sqrt(r_values2)\n\n        ax[1].plot(r_values,x_1,'k')\n\n        ax[1].plot(r_values2,x_2,'k--',r_values2,-x_2,'k--')\n\n        ax[1].set_xlabel('$r$')\n        ax[1].set_ylabel('$x^*$')\n        ax[1].set_xlim([-3,3])\n        ax[1].set_title('Bifurcation diagram')\n        ax[1].plot([r,r],[-3,3],'--')\n\n        \n        x_plot=np.linspace(-3,3)\n        f=super_pitchfork_bfc_rhs(0,x_plot,r)\n        ax[2].plot(x_plot,f)\n        ax[2].set_xlabel('$x$')\n        ax[2].set_ylabel('$f$')\n        ax[2].set_ylim([-2,2])\n        ax[2].plot([u0,u0],[-2,2],'--')\n\n        ax[2].set_title('Phase portrait')\n\n        x_arrows = np.linspace(-1.8, 1.8, 6)\n        f_arrows = r * x_arrows - x_arrows**3\n\n        for xa, fa in zip(x_arrows, f_arrows):\n            if abs(fa) &lt; 1e-3:\n                continue\n            direction = np.sign(fa)\n            ax[2].arrow(\n                xa, 0,\n                0.12 * direction, 0,\n                head_width=0.2,\n                head_length=0.28,\n                fc='k', ec='k',\n                length_includes_head=True\n            )\n        \n                \napp = App(app_ui, server)\nAn app for exploring behaviour of the supercritical pitchfork bifurcation.\n\n\n3.4.2 Subcritical pitchfork\nIn the case of a subcritical pitchform the governing equation is \\[\n\\dot{x}=rx+x^3,\n\\] with \\(r\\in R\\). As this case is very similar to the supercritical pitchfork working out the algebraic details is left as an exercise. In Figure 3.8 note that for \\(r&lt;0\\) there are three fixed points. This time the nontrivial points are linearly unstable whilst \\(x^*=0\\) is linearly stable. For \\(r&gt;0\\) there is a single fixed point that is linearly unstable. At \\(r=0\\) there is a single non-hyperblic fixed point at which \\(f'(0)=0\\). This is unstable. See (subcritbfc?) for bifurcation diagram.\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nx=np.linspace(-1.5,1.5)\n\nr_vec=[-1.0,0.0,1.0]\nfig,ax=plt.subplots(1,3,sharex=True, sharey=True)\nax=ax.flatten()\n\nfor i,r_i in enumerate(r_vec):\n    f=r_i*x+x**3\n    ax[i].plot(x,f)\n    r=r_i\n     # ---- fixed points ----\n    fixed_points = [0.0]\n    if r &lt; 0:\n        fixed_points += [np.sqrt(-r), -np.sqrt(-r)]\n    \n    for x_fp in fixed_points:\n        df = r + 3 * x_fp**2   # derivative at fixed point\n        \n        if df &lt; 0:   # stable\n            ax[i].plot(x_fp, 0, 'ko', markersize=8)\n        else:        # unstable\n            ax[i].plot(x_fp, 0, 'ko', markerfacecolor='white', markersize=8)\n\n    ax[i].axhline(0, color='gray', lw=0.5)\n    ax[i].axvline(0, color='gray', lw=0.5)\n    ax[i].set_title(f\"r = {r}\")\n    ax[i].set_ylim([-2,2])\n\n    x_arrows = np.linspace(-1.8, 1.8, 6)\n    f_arrows = r * x_arrows + x_arrows**3\n\n    for xa, fa in zip(x_arrows, f_arrows):\n        if abs(fa) &lt; 1e-3:\n            continue\n        direction = np.sign(fa)\n        ax[i].arrow(\n            xa, 0,\n            0.12 * direction, 0,\n            head_width=0.08,\n            head_length=0.08,\n            fc='k', ec='k',\n            length_includes_head=True\n        )\n    fig.supxlabel('$x$')\n    fig.supylabel('$\\dot{x}$')\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3.7\n\n\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nr = np.linspace(-2, 2, 400)\n\n# fixed points\nx0 = np.zeros_like(r)\n\nx_plus = np.full_like(r, np.nan)\nx_minus = np.full_like(r, np.nan)\n\nmask = -r &gt;= 0\nx_plus[mask] = np.sqrt(-r[mask])\nx_minus[mask] = -np.sqrt(-r[mask])\n\nfig, ax = plt.subplots(figsize=(6, 5))\n\n# unstable branch x = 0 for r &gt; 0\nax.plot(r[r &gt; 0], x0[r &gt; 0], 'k--', lw=2)\n\n# stable branch x = 0 for r &lt; 0\nax.plot(r[r &lt; 0], x0[r &lt; 0], 'k-', lw=2)\n\n# stable branches ±sqrt(r)\nax.plot(r, x_plus, 'k--', lw=2)\nax.plot(r, x_minus, 'k--', lw=2)\n\nax.axhline(0, color='gray', lw=0.5)\nax.axvline(0, color='gray', lw=0.5)\n\nax.set_xlabel(\"$r$\")\nax.set_ylabel(\"$x*$\")\n\n\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3.8",
    "crumbs": [
      "1D flows",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Bifurcations</span>"
    ]
  },
  {
    "objectID": "Bifurcations.html#application-the-spruce-budworm-model",
    "href": "Bifurcations.html#application-the-spruce-budworm-model",
    "title": "3  Bifurcations",
    "section": "3.5 Application: the spruce budworm model",
    "text": "3.5 Application: the spruce budworm model\nThe spruce budworm is a destructive and widely distributed forest defoliator in North America. Massive outbreaks occur periodically and can destroy large quantities of valuable spruce and fir. To understand the outbreak behaviour and develop and management strategies, a series of mathematical models have been developed, beginning with Ludwig et al. (1978). The goal of the models is to explain the qualitative pattern of sudden outbreaks and then a sudden collapse.\n\n3.5.1 Model development\nLetting \\(N(t)\\) represent the population size at time \\(t\\), it is assumed that budworm exhibits logistic growth and is subject to predation at rate \\(p(N)\\). A governing ordinary differential equation is given by \\[\n\\frac{dN }{dt}= r_B N\\left(1-\\frac{N}{K_B}\\right)-p(N),\n\\tag{3.2}\\] where \\[\np(N) =\\frac{B N^2}{A^2 +N^2},\n\\] \\(r_B\\) is the linear growth rate, \\(K_B\\) is the carrying capacity, \\(B\\) is the maximum rate of predation and \\(A\\) is a measure of budworm population where predation switches on (specifically, \\(A\\) represents the budworm density at which predation is half its maximum value).\nIt is informative to graph the predation term \\[\np(N) =\\frac{B N^2}{A^2 +N^2},\n\\] and annotate the parameters \\(A\\) and \\(B\\).\nThere is a root at \\(N=0\\). In the limit \\(N\\rightarrow \\infty\\), \\(p \\rightarrow B\\). Note that \\(N=A\\), \\(p=A/2\\). The derivative is \\[\np'(N)=\\frac{2BN}{A^2+N^2} - \\frac{2BN^3}{(A^2+N^2)^2} =  \\frac{2BA^2N}{(A^2+N^2)^2}\n\\] Thus there is a turning point at \\(N=0\\) and \\(p'&gt;0 \\forall N&gt;0\\).\n\n\n3.5.2 Nondimensionalisation\nIntroducing the (as yet unspecified) dimensional scalings \\(\\tilde{N}\\) and \\(\\tilde{T}\\), the model is nondimensionalised as follows\n\\[\nn=\\frac{N}{\\tilde{N}} \\ \\ \\ \\ \\ \\ \\tau=\\frac{t}{\\tilde{T}}.\n\\]\nChanging variables in Equation 3.2 yields\n\\[\n\\frac{\\tilde{N}}{\\tilde{T}}\\frac{d n }{d\\tau}= r_B \\tilde{N}n\\left(1-\\frac{\\tilde{N}n}{K_B}\\right)-\\frac{B\\tilde{N}^2n^2}{A^2+\\tilde{N}^2 n^2}.\n\\]\nAfter some tidying\n\\[\n\\frac{dn }{d\\tau}= r_B\\tilde{T} n\\left(1-\\frac{\\tilde{N}n}{K_B}\\right)-\\frac{B\\tilde{N} \\tilde{T}}{A^2}\\frac{n^2}{1+\\frac{\\tilde{N}^2}{A^2}n^2}.\n\\]\nA natural scale for cell density in the model is given by the parameter \\(A\\), as it determines the density of budworm at which predation is half its maximal value. Hence we choose the scaling on the budworm density \\[\n\\tilde{N}=A.\n\\] Similarly, a natural time scale for the model is given by\n\\[\n\\tilde{T}=A/B.\n\\]\nSubstituting for \\(\\tilde{N}\\) and \\(\\tilde{T}\\) yields \\[\n\\frac{dn }{d\\tau}= rn\\left(1-\\frac{n}{q}\\right)-\\frac{n^2}{1+n^2} = H(n),\n\\tag{3.3}\\] where we define the nondimensional parameters \\[\nr= \\frac{r_B A}{B} \\ \\ \\  \\textrm{and} \\ \\ \\  q=\\frac{K_B}{A}.\n\\]\nNote that Equation 3.3 has two nondimensional parameters and all variables are dimensionless. See Figure 3.9 for a plot of right-hand side of equation Equation 3.3. What kind of behaviours do you expect to see from the model?\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport scipy\nfrom scipy.integrate import odeint\n\n\nN_max=12.1\nN_0=0.1\nq=12\nr_1=0.22\nr_2=0.42\nr_3=0.72\n\nn_vec=np.linspace(0,N_max,100)\n\ndef rhssprucebudworm_model(x,t,r,q):\n\n  rhs=r*x*(1-x/q) - x**2/(1+x**2)\n  return rhs\ndef rhssprucebudworm_model_f(x,t,r,q):\n\n  f=r*x*(1-x/q) \n  return f  \ndef rhssprucebudworm_model_g(x,t,r,q):\n\n  g=x**2/(1+x**2)\n  return g  \n\nrhs1=rhssprucebudworm_model(n_vec,0,r_1,q)\nrhs2=rhssprucebudworm_model(n_vec,0,r_2,q)\nrhs3=rhssprucebudworm_model(n_vec,0,r_3,q)\n\n\nfig, ax = plt.subplots()\n\nax.plot(n_vec, rhs1,n_vec, rhs2,n_vec, rhs3)\n\nax.set_xlabel('$N$')\nax.set_ylabel('$H(N)$')\nfig.legend(['r='+str(r_1),'r='+str(r_2),'r='+str(r_3)])\nax.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3.9: Rhs of the spruce budworm model.\n\n\n\n\n\n3.5.3 Numerical solutions\nIn Figure 3.10 we plot some numerical solutions of Equation 3.3 at different values of the parameter \\(r\\).\nNumerical solutions of Equation 3.3 indicate that there is a single stable fixed point when \\(r\\) is both small and large but for intermediate values of \\(r\\) there are two stable fixed points.\nOur goal is to analyse the model and understand why different parameter values yield these strikingly different model behaviours.\n\nCode\n# Define time\nt = np.linspace(0, 100, 101)\n\n# Numerically solve the ODE for differnet parameter values\nsol1 = odeint(rhssprucebudworm_model, N_0, t, args=(r_1, q))\nsol2 = odeint(rhssprucebudworm_model, N_0, t, args=(r_2, q))\nsol3 = odeint(rhssprucebudworm_model, N_0, t, args=(r_3, q))\n\n\n# plot results\nfig, ax= plt.subplots()\nax.plot(t, sol1, 'b', label='r=' +str(r_1))\nax.plot(t, sol2, 'r', label='r='+str(r_2))\nax.plot(t, sol3, 'm', label='r='+str(r_3))\n\nplt.legend(loc='best')\nplt.xlabel('$t$')\nplt.ylabel('$N$')\n\nplt.grid()\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3.10: Numerical solution of spr. budworm model.\n\n\n\n\n\n3.5.4 Fixed point analysis\nLetting \\(n^*\\) represent fixed points of Equation 3.3 yields \\[\nrn^*(1-\\frac{n^*}{q})- \\frac{n^*{^2}}{1+n^*{^2}}=0.\n\\] Hence either \\[\nn^*=0,\n\\] or \\(n^*\\) satisfies the cubic equation \\[\nr\\left(1-\\frac{n^*}{q}\\right)- \\frac{n^*}{1+n^*{^2}}=0.\n\\]\nExplicit solutions to such a cubic can be immediately written down but they are cumbersome to work with. We proceed using a graphical/qualitative approach.\nDefine \\[\nf(n^*)=r\\left(1-\\frac{n^*}{q}\\right) \\ \\ \\textrm{and} \\ \\ g(n^*)=\\frac{n^*}{1+n^*{^2}}.\n\\tag{3.4}\\]\nRoots occur for values of \\(n^*\\) that satisfy \\(f=g\\).\nIn Figure 3.11 (a) we fix the parameter \\(q=10\\) and consider model behaviour as a function of the parameter \\(r\\). When \\(r\\gg1\\) there is a nonzero steady-state corresponding to \\(n^*\\gg 1\\). When \\(r\\ll1\\) there is a nonzero steady-state corresponding to \\(n^*\\ll 1\\). In the intermediate case there can be three intersection points.\nWe can use the curve sketching techniques form Tutorial Sheet 1 to sketch \\(f\\) and \\(g\\).\n\\(f\\) is linear. There is a root at \\(n^*=q\\). The derivative is \\(-r/q\\). \\(f(0)\\)=r. \\(g\\) has a unique root at \\(n^*=0\\). The derivative is \\[\ng'=\\frac{1-n{^*}^2}{(1+n^*)^2}.\n\\] There is a turning point at \\(n^*=1\\). Here \\(g=1/2\\). As \\(n^*\\rightarrow \\infty\\), \\(g\\rightarrow 0\\). \\(f'(0)=1\\).\n\n\n3.5.5 Linear stability analysis\nThe linear stability of the model is determined by the quantity \\[\nH'(n)=r(1-\\frac{2n}{q})-\\frac{2{n}}{1+{n}^2} +\\frac{2{n}^3}{(1+{n}^2)^2}.\n\\]\nHence at the fixed point \\(n^*=0\\) \\[\nH'(0)=r\n\\] and the fixed point is linearly unstable.\nGiven the nonzero fixed points have not been calculated explicitly, we proceed using graphical analysis of stability. In Figure 3.11 (b) we plot the right-hand side of Equation 3.3 against \\(n\\) and examine the cases of large, small and intermediate \\(r\\) for a given value of \\(q\\).\nWhen \\(r\\) is both large and small the nonzero fixed point is stable (the derivative at the roots is negative). In the case where three biologically relevant roots exist, the intermediate root is unstable.\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport scipy\nfrom scipy.integrate import odeint\n\n# Define initial condition\nN_0=0.1\n\n# Define model parameters\nq=12\nr_1=0.2\nr_2=0.5\nr_3=0.8\n\n# Discretise n\nN_max=13\nn_vec=np.linspace(0,N_max,100)\n\n# Function to compute f and g\ndef rhssprucebudworm_model_f(x,t,r,q):\n\n  f=r*(1-x/q) \n  return f  \ndef rhssprucebudworm_model_g(x,t,r,q):\n\n  g=x/(1+x**2)\n  return g  \n\n# Compute f for different values of r and g\nf_1=rhssprucebudworm_model_f(n_vec,0,r_1,q)\nf_2=rhssprucebudworm_model_f(n_vec,0,r_2,q)\nf_3=rhssprucebudworm_model_f(n_vec,0,r_3,q)\ng=rhssprucebudworm_model_g(n_vec,0,r_1,q)\n\n\n# Compute H for different values of r\nh_1=rhssprucebudworm_model(n_vec,0,r_1,q)\nh_2=rhssprucebudworm_model(n_vec,0,r_2,q)\nh_3=rhssprucebudworm_model(n_vec,0,r_3,q)\n\n\n# Plot results\nfig, ax = plt.subplots(1,2)\n\nax[0].plot(n_vec, f_1,n_vec, f_2,n_vec, f_3,n_vec,g)\nax[0].set_xlabel('$n$')\nax[0].set_ylabel('$f,g$')\nax[0].grid(True)\nax[0].legend(['r='+str(r_1),'r='+str(r_2),'r='+str(r_3)])\nax[1].plot(n_vec, h_1,n_vec, h_2,n_vec, h_3)\nax[1].set_xlabel('$n$')\nax[1].set_ylabel('$H$')\nax[1].grid(True)\nax[1].legend(['r='+str(r_1),'r='+str(r_2),'r='+str(r_3)])\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3.11: RHS of spr. budworm model.\n\n\n\n\n\n3.5.6 Bifurcation analysis\nThe goal is to identify boundaries of \\(rq\\) parameter space where the stability changes occur and/or the number of fixed points changes.\nAt the transitions between different qualitative regimes pairs of fixed points can appear/disappear at critical values of \\(r\\). In these cases one of the fixed points is linearly stable and the other linerly unstable. Hence these are saddle-node bifurcations.\nWe can define points in \\(rq\\) parameter space where bifurcations arise by seeking values of \\(n^*\\) that satisfy \\[\nf(n^*)= g(n^*) \\ \\ \\ \\  f'(n^*)= g'(n^*).\n\\]\nThe first of these equations yields \\[\n  r(1-\\frac{n^*}{q}) = \\frac{n^*}{1+n{^*}^{2}},\n\\tag{3.5}\\] and the latter yields \\[\n-\\frac{r}{q}=\\frac{1}{1+n{^*}^{2}}-\\frac{2n{^*}^{2}}{(1+n{^*})^2} = \\frac{1-n{^*}^{2}}{(1+n{^*}^{2})^2}.\n\\tag{3.6}\\]\nHence \\[\n   \\frac{r}{q}= \\frac{n{^*}^{2}-1}{(1+n{^*}^{2})^2}.\n\\]\nSubstituting for \\(r/q\\) in the first equation yields \\[\nr-\\frac{n{^*}^{2}-1}{(1+n{^*}^{2})^2}n^*=\\frac{n^*}{1+n{^*}^{2}},\n\\] which can be written in the form \\[\nr=\\frac{2n{^*}^{3}}{(1+n{^*}^{2})^2}.\n\\] Substituting for \\(r\\) in Equation 3.5 yields \\[\n\\frac{2n{^*}^{3}}{(1+n{^*}^{2})^2}=\\frac{2n{^*}^{3}}{(1+n{^*}^{2})^2}\\frac{n^*}{q}+\\frac{n^*}{1+n{^*}^2}\n\\] which, after some algebra, yields \\[\nq=\\frac{2n{^*}^3}{n{^*}^{2}-1}.\n\\tag{3.7}\\] Hence a set of points that define bifurcations where three fixed points transform to a single fixed point are given in parametric form in \\(qr\\) parameter space by \\[\n\\left(\\frac{2n{^*}^3}{n{^*}^{2}-1},\\frac{2n{^*}^{3}}{(1+n{^*}^{2})^2}\\right) \\ \\ \\ \\ \\ \\ \\ n^*&gt;1.\n\\]\n\nCode\n# Function to compute bifurcation values of r and q as a function of n_star\ndef Computerq(x):\n  q_n_star=2*x**3/(x**2-1)\n  r_n_star=2*x**3/(1+x**2)**2\n  return  r_n_star,q_n_star\n\n# Define different domains of n\nn_s_1=np.linspace(1,np.sqrt(3),100)\nn_s_2=np.linspace(np.sqrt(3),200,100)\n\n# Compute r and q\nr_1,q_1=Computerq(n_s_1)\nr_2,q_2=Computerq(n_s_2)\n\n# Plot results\nfig, ax = plt.subplots(1)\n\nax.plot(q_1, r_1,q_2, r_2)\nplt.xlabel('$q$')\nplt.ylabel('$r$')\nax.set_xlim([0, 100])\nplt.grid(True)\n\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3.12: Bifurcations in the rq plane.\n\n\n\nBy varying values of \\(n^*\\) in Figure 3.12 we plot a region of instability. Note for example that \\(q\\rightarrow \\infty\\) as \\(n^*\\rightarrow 1\\) and as \\(n^*\\rightarrow \\infty\\). Note also that in these limits \\(r\\) must take the value 1/2 and 0, respectively.\nWe can show that the cusp in Figure 3.12 is given by \\[\n\\left(q,r\\right)=\\left(3^{\\frac{3}{2}},\\left(\\frac{\\sqrt{3}}{2}\\right)^3\\right).\n\\]\nNote that \\(r\\) is a decreasing function of \\(q\\) for \\(1&lt;n^*&lt;\\sqrt{3}\\) but that \\(r\\) is an increasing function of \\(n^*\\) for \\(\\sqrt{3}&lt;n^*&lt;\\infty\\). This can be shown by finding the turning points of \\(r\\) w.r.t \\(n^*\\), i.e. Given that \\[\nr=\\frac{2n{^*}^{3}}{(1+n{^*}^{2})^2},\n\\] differentiation with respect to \\(n^*\\) yields \\[\n\\frac{dr}{dn^*}=\\frac{6{n^*}^2}{(1+n^*)^2} - \\frac{8n{^*}^4}{(1+n^*)^3}.\n\\] The turning point satisfies \\[\n\\frac{6{n^*}^2}{(1+n^*)^2} - \\frac{8n{^*}^4}{(1+n^*)^3}=0\n\\] Solving for \\(n^*\\) yields \\[\n6(1+{n^*}^2) - 8n{^*}^2=0\n\\] Hence \\[\n  n^*=\\sqrt{3}.\n\\] Thus there is a turning point that minimises \\(r\\) at \\(n^*=\\sqrt{3}\\).\nSubstitution for this value of \\(n^*\\) yields \\[\n\\left(q,r\\right)=\\left(3^{\\frac{3}{2}},\\left(\\frac{\\sqrt{3}}{2}\\right)^3\\right).\n\\] See Figure 3.12.\n\n\n3.5.7 Hysteresis\nFinally, rearranging the steady-state equation \\[\n  r(1-\\frac{n^*}{q}) = \\frac{n^*}{1+n{^*}^{2}},\n\\] we obtain \\[\n   r = \\frac{n^*}{(1+n{^*}^{2})(1-\\frac{n^*}{q})}.\n\\tag{3.8}\\]\nConsidering \\(n^*&lt;q\\) we compute \\(r\\); plotting \\(n^*\\) against \\(r\\) yields the bifurcation curve presented in Figure 3.13.\n\nCode\n# Compute r as a function of n\ndef Computern(x,q):\n  r=x/((1+x**2)*(1-x/q))\n  return  r\n\n# Define different domains of n for plotting \nq=12\nn_s_1=np.linspace(1,np.sqrt(3),100)\nn_s_2=np.linspace(np.sqrt(3),0.99*q,100)\nn_s_3=np.linspace(0,np.sqrt(3),100)\n\n\n# Evaluate r\nr_1=Computern(n_s_1,q)\nr_2=Computern(n_s_2,q)\nr_3=Computern(n_s_3,q)\n\n\n# Plote results\nfig, ax = plt.subplots(1)\n\nax.plot(r_1, n_s_1,r_2, n_s_2,r_3,n_s_3)\nplt.xlabel('$r$')\nplt.ylabel('$n^*$')\nax.set_xlim([0, 2])\nplt.grid(True)\n\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3.13: Bifurcations in the rq plane.\n\n\n\nA system exhibiting hysteresis shows a response to an increases in a control parameter that is not exactly reversed when the parameter is decreased. We can show that the spruce budworm model exhibits hysteresis by considering the argument below.\nSuppose \\(r\\) is initially small (\\(r&lt;r_1\\)). There is only one steady-state and any initial condition will converge towards it.\nSuppose we increase the value of the parameter \\(r\\). There will be a critical value of \\(r\\) (\\(r=r_1\\))where a second stable steady-state arises and the model enters the bistable regime, where there are two possible stable steady-states. Given the system system was originally in the first stable fixed point, it will remain there.\nSuppose we continue to increase \\(r\\). Eventually we reach critical value of \\(r\\) (\\(r=r_2\\)) where the first stable fixed point is lost and there is again only one stable steady-state.\nSuppose we now decrease the parameter \\(r\\) below the threshold \\(r=r_2\\). The system again enters the bistable regime but as the second solution is stable, it remains the solution.\nSuppose we continue to decrease \\(r\\) until eventually \\(r&lt;r_1\\). We return to the case where the system has only a single stable fixed point.",
    "crumbs": [
      "1D flows",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Bifurcations</span>"
    ]
  },
  {
    "objectID": "Bifurcations.html#references",
    "href": "Bifurcations.html#references",
    "title": "3  Bifurcations",
    "section": "3.6 References",
    "text": "3.6 References\n\n\n\n\nLudwig, Donald, Dixon D Jones, Crawford S Holling, et al. 1978. “Qualitative Analysis of Insect Outbreak Systems: The Spruce Budworm and Forest.” Journal of Animal Ecology 47 (1): 315–32.",
    "crumbs": [
      "1D flows",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Bifurcations</span>"
    ]
  },
  {
    "objectID": "2DLinearSystems.html",
    "href": "2DLinearSystems.html",
    "title": "4  Linear systems",
    "section": "",
    "text": "4.1 Introduction\nA 2D linear system has two dependent variables with coupled dynamics. You will have met this system before in the Differential Equations module.\nConsider \\[\n\\begin{aligned}\n\\dot{x} &=ax+by \\\\\n\\dot{y}&=cx+dy\n\\end{aligned}\n\\]\nIn matrix form \\[\n\\dot{\\mathbf{x}}=A\\mathbf{x}\n\\tag{4.1}\\] where \\[\nA=\n\\begin{pmatrix}\na & b \\\\\nc & d\n\\end{pmatrix}\n\\] and \\[\n\\mathbf{x}(t)=\\begin{pmatrix}\nx(t)  \\\\ y(t)\n\\end{pmatrix}\n\\]",
    "crumbs": [
      "2D flows",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Linear systems</span>"
    ]
  },
  {
    "objectID": "2DLinearSystems.html#a-solution-for-linear-problems",
    "href": "2DLinearSystems.html#a-solution-for-linear-problems",
    "title": "4  Linear systems",
    "section": "4.2 A solution for linear problems",
    "text": "4.2 A solution for linear problems\n\n4.2.1 Linear superposition\nIt is straightforward to show that if \\(\\mathbf{x}_1(t)\\) and \\(\\mathbf{x}_2(t)\\) are solutions, the linear sum \\[\nc_1\\mathbf{x}_1(t) +  c_2 \\mathbf{x}_2(t),\n\\] where \\(c_1\\) and \\(c_2\\) are arbitrary constants, is itself a solution.\n\n\n4.2.2 A general solution\nSeeking a solution of Equation 5.4 of the form\n\\[\n\\mathbf{w}=\\mathbf{v}e^{\\lambda t}\n\\]\none obtains the characteristic equation\n\\[\n\\lambda^2 -\\lambda \\mathrm{tr}(A)+\\det(A)=0,\n\\] which has solutions\n\\[\n\\lambda = \\frac{\\mathrm{tr}{A}\\pm \\sqrt{\\mathrm{tr}{A}^2-4\\det{A}}}{2}.\n\\]\nGiven distinct eigenvalues, the general solution is \\[\n\\mathbf{x}(t)=C_1\\mathbf{v}_1e^{\\lambda_1 t}+C_2\\mathbf{v}_2 e^{\\lambda_2 t}.\n\\tag{4.2}\\]\nThe behaviour of the solutions of a 2D linear system of ODEs can be classified given the knowledge of the eigenvectors/eigenvalues.",
    "crumbs": [
      "2D flows",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Linear systems</span>"
    ]
  },
  {
    "objectID": "2DLinearSystems.html#fixed-points-and-their-stability",
    "href": "2DLinearSystems.html#fixed-points-and-their-stability",
    "title": "4  Linear systems",
    "section": "4.3 Fixed points and their stability",
    "text": "4.3 Fixed points and their stability\n\n4.3.1 Fixed points\nFixed points of Equation 5.4 satisfy \\[\nA\\mathbf{x} = \\mathbf{0}.\n\\tag{4.3}\\]\nThe zero vector \\[\n\\mathbf{x}^*=\\mathbf{0} = \\begin{pmatrix}0 \\\\ 0 \\end{pmatrix}\n\\] is always a fixed point of Equation 4.3.\nIf \\(A\\) is invertible then the zero vector is a unique fixed point of Equation 5.4.\nIf \\(A\\) is not invertible there exists an infinite family of fixed points (line or plane).\n\n\n4.3.2 Stability\n\n\n4.3.3 Asymptotic stability\nGiven the general solution \\[\n\\mathbf{x}(t)=C_1\\mathbf{v}_1e^{\\lambda_1 t}+C_2\\mathbf{v}_2 e^{\\lambda_2 t},\n\\] the fixed point (0,0) is asymptotically stable if \\[\n\\Re\\{\\lambda_i\\} &lt;0 \\  \\forall \\  i.\n\\]\n\n4.3.3.1 Classification via the trace-determinant plane\nThe stability of a linear 2D system can be determined by calculating determinant and trace of A and referring to Figure 4.1.\n\n\n\n\n\n\nFigure 4.1: Stability in the trace determinant plane.\n\n\n\nThe different cases can be categorised as follows:\n\n\\(\\det(A)&lt;0\\) There is one positive and one negative real eigenvalue. Hence the fixed point is a saddle which is unstable.\n\\(\\det(A)&gt;0\\) The fixed point can be either stable or unstable, depending on \\(\\mathrm{tr}(A)\\) (and the real part of the eigenvalues).\n\nIf \\(\\mathrm{tr}(A)&gt;0\\), the fixed point is unstable.\n\nIf \\(\\mathrm{tr}(A)^2&gt;4 \\det(A)\\), it is an unstable node.\nIf \\(\\mathrm{tr}(A)^2&lt;4 \\det(A)\\) it is an unstable spiral.\n\nIf \\(\\mathrm{tr}(A)&lt;0\\), the fixed point is stable.\n\nIf \\(\\mathrm{tr}(A)^2&gt;4 \\det(A)\\), it is an stable node.\nIf \\(\\mathrm{tr}(A)^2&lt;4 \\det(A)\\), it is an stable spiral.\n\nIf \\(\\mathrm{tr}(A)=0\\) the fixed point is a centre.\n\n\nThese different cases can be distinguished in the trace-determinant plane plotted in Figure 4.1.\nNote the following:\n\nThe condition \\(\\det(A)&gt;0\\) excludes the case that the eigenvalues are real but have opposite signs (i.e. it cannot be a saddle point).\nThe condition \\(\\mathrm{tr}(A)&gt;0\\) implies that the real part of both eigenvalues are positive (i.e. the fixed point is unstable).\nThe condition \\(\\mathrm{tr}(A)^2&lt;4 \\det(A)\\) implies that the eigenvalues are complex. Hence \\[\n\\lambda_{\\pm}=\\mu\\pm i\\omega \\ \\ \\\n\\] and the solution of the system can be written \\[\ne^{\\lambda t} = e^{(\\mu+i\\omega) t} = e^{\\mu t}e^{i\\omega t}.\n\\] For \\(\\mu&gt;0\\) the magnitude of the perturbation grows but it oscillates about the fixed point. Hence the fixed point is an unstable spiral.\n\n\n\n4.3.3.2 Introducing different types of stability\nIn 2D system we need to make a more nuanced description of stability:\n\nan attracting fixed point - all trajectories that start close to a fixed point approach it as \\(t\\rightarrow \\infty\\).\nglobally attracting - all trajectories tend to the fixed point as \\(t\\rightarrow \\infty\\) ,\nLiapunov stable - all trajectories that get close to a fixed point stay close to it for all time.\nneutrally stable - a fixed point that is Liapunov stable but not attracting\nasymptotically stable - a fixed point that is Liapunov stable and attracting.\n\n\n\n4.3.3.3 Stable and unstable manifolds\nA stable manifold of a fixed point, \\(\\mathbf{x}^*\\), is a set of points such that\n\\[\n\\{ \\mathbf{s}: \\mathbf{x}(t)\\rightarrow \\ \\mathbf{x}^* \\  \\textrm{as} \\ t\\rightarrow \\infty \\ \\textrm{for} \\ \\mathbf{x}(0)=\\mathbf{s} \\}\n\\]\nAn unstable manifold of the fixed point is the set of points such that\n\\[\n\\{ \\mathbf{u}: \\mathbf{x}(t)\\rightarrow \\ \\mathbf{x}^* \\ \\textrm{as} \\ t\\rightarrow -\\infty \\ \\textrm{for} \\ \\mathbf{x}(0)=\\mathbf{u} \\}\n\\]",
    "crumbs": [
      "2D flows",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Linear systems</span>"
    ]
  },
  {
    "objectID": "2DLinearSystems.html#an-example-problem-introducing-phase-portraits-and-stability",
    "href": "2DLinearSystems.html#an-example-problem-introducing-phase-portraits-and-stability",
    "title": "4  Linear systems",
    "section": "4.4 An example problem introducing phase portraits and stability",
    "text": "4.4 An example problem introducing phase portraits and stability\nLet’s consider a decoupled 2D problem given by\n\\[\n\\begin{aligned}\n\\dot{x}=ax \\\\\n\\dot{y}=-y,\n\\end{aligned}\n\\] where \\(a \\in \\Re\\). We will use this system to introduce some important concepts regarding phase portraits and stability.\nThe solution is \\[\nx(t)=x_0e^{at}, \\quad y(t)=y_0e^{-t}.\n\\]\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nx_0_vec=[-2,-1,0,1,2]\ny_0_vec=[-2,-1,0,1,2]\n\nt=np.linspace(0,20,1000,dtype=float)\n\nind=5\n\nfig,ax=plt.subplots(2,3)\nax=ax.flatten()\na_vec=np.array([-1.5,-1.0,-0.5,0.0,0.5,1.5])\na_vec=a_vec.astype(float)\n\nk=0\ntitle_vec=['a','b','c','d','e','f']\nfor a in a_vec:\n    for x_0 in x_0_vec:\n        for y_0 in y_0_vec:\n            sol_x=x_0*np.exp(a*t)\n            sol_y=y_0*np.exp(-t)\n            \n            sol_x_rev=x_0*np.exp(a*t*-1)\n            sol_y_rev=y_0*np.exp(-t*-1)\n\n            ax[k].plot(sol_x,sol_y,'k',sol_x_rev,sol_y_rev,'k')\n            ax[k].annotate('',\n            xy=(sol_x[ind], sol_y[ind]),        # arrow head\n            xytext=(sol_x[ind-2], sol_y[ind-2]),  # arrow tail\n            arrowprops=dict(\n            arrowstyle='-&gt;',\n            color='black'\n            ),\n            ha='center'\n        )\n    ax[k].set_xlim([-3,3])\n    ax[k].set_ylim([-3,3])\n    ax[k].set_title('('+title_vec[k]+')' + ': $a = $' + str(a))\n    ax[k].set_xlabel('$x$')\n    ax[k].set_ylabel('$y$')\n\n    ax[k].grid()\n    x=[np.pi]\n    y=[0.0, 0.0,0.0,0.0]\n    # Arrow start\n    x0=[0.0,2.0*np.pi,0.0,-2.0*np.pi]\n    y0 = [0.0,0.0,0.0,0.0]\n    \n    k+=1\nfig.tight_layout()\nplt.show()\n\n\n\n\n\n\n\n\nFigure 4.2\n\n\n\n\n\nThis app explores solutions of the problem \\[\n\\dot{\\mathbf{x}}=A\\mathbf{x}\n\\] where \\[\nA=\\begin{pmatrix} a & 0 \\\\ 0 & -1 \\end{pmatrix}.\n\\] Solution trajectories are sampled over a range of initial conditions. The eigenvalues are plotted in the complex plane. In this case they are real and take values \\(a\\) and -1.\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| viewerHeight: 600\n#| label: fig-transcrit\n\n\nfrom shiny import App, Inputs, Outputs, Session, render, ui\nfrom shiny import reactive\n\nimport numpy as np\nfrom pathlib import Path\nimport matplotlib.pyplot as plt\nfrom scipy.integrate import odeint\nfrom scipy.integrate import solve_ivp\n\napp_ui = ui.page_fluid(\n                     \n    ui.input_slider(id=\"r\",label=\"a\",min=-2.0,max=2.0,value=0.1,step=0.1),\n    ui.output_plot(\"plot\"),\n\n)\n\ndef server(input, output, session):\n    @output\n    @render.plot\n    def plot():\n        fig, ax = plt.subplots(3,1,figsize=(15, 5))\n        ax=ax.flatten()\n        #ax.set_ylim([-2, 2])\n        #         \n        r=float(input.r())\n    \n        \n        x_0_vec=[-2,-1,0,1,2]\n        y_0_vec=[-2,-1,0,1,2]\n\n        t=np.linspace(0,20,1000,dtype=float)\n\n        ind=5\n\n        \n        a=r\n\n        for x_0 in x_0_vec:\n            for y_0 in y_0_vec:\n                sol_x=x_0*np.exp(a*t)\n                sol_y=y_0*np.exp(-t)\n                \n                sol_x_rev=x_0*np.exp(a*t*-1)\n                sol_y_rev=y_0*np.exp(-t*-1)\n\n                ax[0].plot(sol_x,sol_y,'k',sol_x_rev,sol_y_rev,'k')\n                ax[0].annotate('',\n                xy=(sol_x[ind], sol_y[ind]),        # arrow head\n                xytext=(sol_x[ind-2], sol_y[ind-2]),  # arrow tail\n                arrowprops=dict(\n                arrowstyle='-&gt;',\n                color='black'\n                ),\n                ha='center'\n            )\n        ax[0].set_xlim([-3,3])\n        ax[0].set_ylim([-3,3])\n        ax[0].grid()\n        ax[0].set_xlabel('$x$')\n        ax[0].set_ylabel('$y$')\n\n        ax[1].plot(-1,0,'k*',a,0,'m^')\n        ax[1].plot([0,0],[-2,2])\n        ax[1].set_xlabel('$\\Re(\\lambda)$')\n        ax[1].set_ylabel('$\\Im(\\lambda)$')\n        ax[1].set_title('Eigenvalue spectrum')\n        ax[1].set_xlim([-2,2])\n\n        tr_A=r-1\n        detA=-r\n\n        tr_plot=np.linspace(-3,3,100)\n        det_plot=0.25*tr_plot**2\n        ax[2].plot(tr_A,detA,'k*')\n        ax[2].plot(tr_plot,det_plot)\n        ax[2].plot([-3,3],[0,0])\n        ax[2].plot([0,0],[-2,2],)\n        ax[2].set_xlabel('Tr')\n        ax[2].set_ylabel('Det')\n        ax[2].set_xlim([-3,3])\n        ax[2].set_ylim([-2,2])\n        ax[2].set_title('Trace-determinant plane')\n               \napp = App(app_ui, server)\nAn app for exploring qualitatively distinct dynamics in a 2D linear system.\nIn Figure 4.2 we cna make the following classifications:\n\nstable node. As \\(a&lt;1\\) the solutions decay faster along the \\(x\\) axis.\nstar node - the eigenvalues are equal.\nstable node - not \\(-1&lt;a&lt;0\\) so the solution decays faster along the \\(y\\) axis.\ninfinite family of fixed points.\nsaddle - one stable eigenvector and one unstable eigenvector.\n\n(a-c) The fixed point is globally attracting. The stable manifold is \\[\n\\{s: s\\in\\Re^2\\}.\n\\]\n\nfixed points are neutrally stable (e,f)\n\nunstable fixed point\nstable manifold \\[\n  \\{(x,y): x=0, \\ \\forall y \\}.\n\\]\nunstable manifold \\[\n  \\{(x,y): y=0 \\ \\forall x \\}.\n\\]",
    "crumbs": [
      "2D flows",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Linear systems</span>"
    ]
  },
  {
    "objectID": "2DLinearSystems.html#jordan-form",
    "href": "2DLinearSystems.html#jordan-form",
    "title": "4  Linear systems",
    "section": "4.5 Jordan form",
    "text": "4.5 Jordan form\nConsider the system of linear ODEs given by \\[\n\\dot{\\mathbf{x}}=A\\mathbf{x}, \\quad \\mathbf{x}(0)=\\mathbf{x}_0,\n\\] where \\(A\\) is a \\(n\\times n\\) matrix.\nConsider a change of coordinates such that \\[\n\\mathbf{x}=P\\mathbf{y}\n\\] where \\(P\\) is an \\(n\\times n\\) invertible matrix (\\(\\det{P}\\neq 0\\)). Then\n\\[\n\\dot{\\mathbf{x}}=A\\mathbf{x}\n\\] implies \\[\n\\dot{y}=P^{-1}\\dot{x}=P^{-1}A\\mathbf{x} =  P^{-1}AP\\mathbf{y}=\\Gamma y\n\\] where \\[\n\\Gamma= P^{-1}AP,\n\\] and the initial condition transforms to\n\\[\n\\mathbf{y}_0=P^{-1}\\mathbf{x}_0.\n\\]\nIn these new coordinates the solution is \\[\n\\mathbf{y}(t)=e^{t\\Gamma}\\mathbf{y}_0.\n\\] Transforming back to original coordinates \\[\n\\mathbf{x}(t)=P y(t)= P e^{t\\Gamma}\\mathbf{y}_0= P e^{t\\Gamma}P^{-1}\\mathbf{x}_0.\n\\]\nSuppose that \\(A\\) has \\(n\\) distinct eigenvalues (\\(\\lambda_1\\),\\(\\lambda_2\\),…,\\(\\lambda_n\\)) with associated eigenvectors (\\(\\mathbf{e}_1\\),\\(\\mathbf{e}_2\\),…,\\(\\mathbf{e}_n\\)). Let \\(P\\) be the matrix with eigenvectors as columns, i.e. \\[\nP=[\\mathbf{e}_1,\\mathbf{e}_2,...,\\mathbf{e}_n]\n\\] Hence \\(\\Gamma=P^{-1}AP\\) is a diagonal matrix with eigenvalues along the diagonal axis. The component solution has the form \\[\ny_{i}(t)=y_{0i}e^{\\lambda_i t}.\n\\]",
    "crumbs": [
      "2D flows",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Linear systems</span>"
    ]
  },
  {
    "objectID": "2DNonLinearPhasePlane.html",
    "href": "2DNonLinearPhasePlane.html",
    "title": "5  2D nonlinear systems",
    "section": "",
    "text": "5.1 Introduction\nConsider the system of nonlinear ODEs given by \\[\n\\begin{aligned}\n\\dot{x}&=f(x,y),\\\\\n\\dot{y}&=g(x,y),\n\\end{aligned}\n\\tag{5.1}\\] where \\(f\\) and \\(g\\) are smooth functions of \\(x\\) and \\(y\\).\nIn vector form \\[\n\\dot{\\mathbf{x}}=\\mathbf{f}(\\mathbf{x})\n\\] where \\(\\mathbf{x}=(x,y)^T\\) and \\(\\mathbf{f}=(f,g)^T\\).\nHere \\(\\mathbf{x}\\) represents a point in the phase plane, \\(\\dot{\\mathbf{x}}\\) represents the velocity. By flowing along the vector field, a phase point traces out a trajectory \\(\\mathbf{x}(t)\\). As each point in the plane can be an initial condition, the plane is filled with trajectories.",
    "crumbs": [
      "2D flows",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>2D nonlinear systems</span>"
    ]
  },
  {
    "objectID": "2DNonLinearPhasePlane.html#existence-uniqueness-and-topological-consequences",
    "href": "2DNonLinearPhasePlane.html#existence-uniqueness-and-topological-consequences",
    "title": "5  2D nonlinear systems",
    "section": "5.2 Existence, uniqueness and topological consequences",
    "text": "5.2 Existence, uniqueness and topological consequences\n\nTheorem 1Consider the initial value problem \\[\n\\dot{\\mathbf{x}}=\\mathbf{f}(\\mathbf{x}), \\quad \\mathbf{x}(0)=\\mathbf{x}_0,\n\\] Suppose that \\(\\mathbf{f}\\) is continuous and that all partial derivatives exist and are continuous in some open connected set \\(D\\subset \\mathbf R ^n\\). For \\(\\mathbf{x}_0 \\in D\\), the IVP has a unique solution in some time interval \\(t \\in (\\tau,\\tau)\\).\n\n\n\nCorollary 2Different trajectories never intersect.\n\n\n\nCorollary 3In 2D, trajectories initialised inside a closed orbit remain trapped inside it for all time.",
    "crumbs": [
      "2D flows",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>2D nonlinear systems</span>"
    ]
  },
  {
    "objectID": "2DNonLinearPhasePlane.html#fixed-points-and-linearisation",
    "href": "2DNonLinearPhasePlane.html#fixed-points-and-linearisation",
    "title": "5  2D nonlinear systems",
    "section": "5.3 Fixed points and linearisation",
    "text": "5.3 Fixed points and linearisation\n\n5.3.1 Fixed points\n\\((x^*,y^*)\\) is defined to be a fixed point of Equation 5.1 if\n\\[\nf(x^*,y^*)=g(x^*,y^*)=0.\n\\]\nHence, by definition, the time derivatives of \\(x(t)\\) and \\(y(t)\\) are both zero at \\((x^*,y^*)\\). As was the case for single species models, fixed points are obtained by solving algebraic equations.\n\n\n5.3.2 Linear stability analysis\nSuppose that \\((x^*,y^*)\\) is a fixed point of equations Equation 5.1.\nWe consider a change of dependent variables such that\n\\[\nx(t)=x^*+ \\hat{x}(t)  \\  \\  \\textrm{and} \\ \\ y(t)=y^*+\\hat{y}(t),\n\\]\nwhere \\(\\hat{x}(t)\\) and \\(\\hat{y}(t)\\) are perturbations about the fixed point.\nRewriting equation Equation 5.1 in the transformed variables yields\n\\[\n\\begin{aligned}\n\\frac{d\\hat{x}}{dt}&=f(x^*+\\hat{x},y^*+\\hat{y}),  \\nonumber \\\\\n\\frac{d\\hat{y}}{dt}&=g(x^*+\\hat{x},y^*+\\hat{y}).\n\\end{aligned}\n\\tag{5.2}\\]\nMaking Taylor expansions about \\((x^*,y^*)\\) yields the linearised equations\n\\[\n\\begin{aligned}\n\\frac{d\\hat{x}}{dt}=\\frac{\\partial f}{\\partial x}_{|(x^*,y^*)} \\hat{x} +  \\frac{\\partial f}{\\partial y}_{|(x^*,y^*)}  \\hat{y} + h.o.t, \\nonumber\\\\\n\\frac{d\\hat{y}}{dt}=\\frac{\\partial g}{\\partial x}_{|(x^*,y^*)}  \\hat{x} +  \\frac{\\partial g}{\\partial y}_{|(x^*,y^*)}  \\hat{y} + h.o.t. \\nonumber\n\\end{aligned}\n\\tag{5.3}\\]\nDefining \\[\n\\mathbf{w}=\\left\n(\\begin{array}{r}\n\\hat{x} \\\\\n\\hat{y}\n\\end{array}\\right),\n\\]\nyields the matrix form\n\\[\n\\frac{d \\mathbf{w}}{dt}= A \\mathbf{w},\n+ h.o.t\n\\tag{5.4}\\]\nwhere the matrix \\(A\\), known as the Jacobian matrix, takes the form\n\\[\nA=\\left(\\begin{array}{rr}\n\\frac{\\partial f}{\\partial x}&\\frac{\\partial f}{\\partial y} \\\\ \\frac{\\partial g}{\\partial x}&\\frac{\\partial g}{\\partial y} \\end{array}\\right)_{(x^*,y^*)}. \\qquad\n\\]\nIn the neighbourhood of fixed points, we expect the higher order terms to become vanishingly small. If we are willing to neglect the higher order terms then close to the fixed points we can describe the dynamics the dynamics using the linearised system \\[\n\\frac{d \\mathbf{w}}{dt}= A \\mathbf{w},\n\\tag{5.5}\\]",
    "crumbs": [
      "2D flows",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>2D nonlinear systems</span>"
    ]
  },
  {
    "objectID": "2DNonLinearPhasePlane.html#phase-portraits",
    "href": "2DNonLinearPhasePlane.html#phase-portraits",
    "title": "5  2D nonlinear systems",
    "section": "5.4 Phase portraits",
    "text": "5.4 Phase portraits\nFor nonlinear problems it is usually impossible to find trajectories analytically. Instead, our goal is to describe the qualitative behaviour of trajectories. Some important features of phase portraits are:\n\nfixed points\nclose orbits\nbehaviour of trajectories close to fixed points\nthe stability of any fixed points and closed orbits\nthe vector field\nnullclines\n\nWe can often sketch solutions in the phase plane using the above information.\n\nExample 5.1 Plot a phase portrait for the system: \\[\n\\begin{aligned}\n\\dot{x}&=x+e^{-y}\\\\\n\\dot{y}&=-y\n\\end{aligned}\n\\]\nStrategy: - fixed points and their linear stability - nullclines - derivative/vector field - sample trajectories",
    "crumbs": [
      "2D flows",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>2D nonlinear systems</span>"
    ]
  },
  {
    "objectID": "2DNonLinearPhasePlane.html#neglecting-nonlinear-terms",
    "href": "2DNonLinearPhasePlane.html#neglecting-nonlinear-terms",
    "title": "5  2D nonlinear systems",
    "section": "5.5 Neglecting nonlinear terms?",
    "text": "5.5 Neglecting nonlinear terms?\n\nDefinition 4A fixed point of an \\(n^{th}\\) order system is hyperbolic if all the eigenvalues of the linear system lie off the imaginary axis (i.e. \\(\\Re(\\lambda_i) \\ \\neq  \\ 0 \\\\forall i\\)).\n\n\n\nTheorem 5Hartman-Grobman\nThe local phase portrait near a hyperbolic fixed point is topologically equivalent (i.e. homeomorphic) to the phase portrait of the linearisation.\n\n\n\nDefinition 6Structural stability\nA phase portrait is structurally stable if its topology cannot be changed by an arbitrarily small change to the vector field.\n\n\n\nExample 5.2 Consider the system \\[\n\\begin{aligned}\n\\dot{x} & =-y+ax(x^2+y^2)\\\\\n\\dot{y} & =x+ay(x^2+y^2)\n\\end{aligned}\n\\] where \\(a\\in\\Re\\). Show that the linearised system incorrectly predicts that the origin is a centre. By transforming to polar coordinates show that the system is actually either a stable/unspiral for \\(a\\neq 0\\).",
    "crumbs": [
      "2D flows",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>2D nonlinear systems</span>"
    ]
  },
  {
    "objectID": "2DNonLinearPhasePlane.html#competition",
    "href": "2DNonLinearPhasePlane.html#competition",
    "title": "5  2D nonlinear systems",
    "section": "5.6 Competition",
    "text": "5.6 Competition\nIn models of competition, two or more species compete for the same resource or in some way inhibit each other’s growth. Letting \\(N_1(t)\\) and \\(N_2(t)\\) represent the population density of two species, we consider the ODEs \\[\n\\begin{aligned}\n\\frac{d N_1}{dt} &= r_1N_1\\left(1-\\frac{N_1}{K_1}-b_{12}\\frac{N_2}{K_1}\\right), \\nonumber \\\\\n\\frac{d N_2}{dt} &= r_2N_2\\left(1-\\frac{N_2}{K_2}-b_{21}\\frac{N_1}{K_2}\\right),\n\\end{aligned}\n\\] where \\(r_1\\), \\(r_2\\), \\(K_1\\) and \\(K_2\\) are positive constants. As before, the \\(r's\\) are linear growth rates and the \\(K\\)’s are carrying capacities. The parameters \\(b_{12}\\) and \\(b_{21}\\) measure the competitive effect of \\(N_2\\) on \\(N_1\\) and \\(N_1\\) on \\(N_2\\), respectively.\n\n5.6.1 Nondimensionalisation\nAfter nondimensionalising using the change of variables\n\\[\nn_1=\\frac{N_1}{K_1} \\ \\ n_2=\\frac{N_2}{K_2} \\ \\ \\tau=\\frac{t}{\\frac{1}{r_1}},\n\\]\nwe obtain the equations\n\\[\n\\begin{aligned}\n\\frac{d n_1}{d\\tau} &= n_1\\left(1- n_1-a_{12}n_2\\right) = f(n_1,n_2), \\nonumber \\\\\n\\frac{d n_2}{d\\tau} &= \\rho n_2\\left(1-n_2-a_{21}n_1\\right) =g(n_1,n_2),\n\\end{aligned}\n\\tag{5.6}\\]\nwhere\n\\[\n\\rho=\\frac{r_2}{r_1}, \\ \\ \\ a_{12}=b_{12}\\frac{K_2}{K_1}, \\ \\ \\  a_{21}=b_{21}\\frac{K_1}{K_2}.\n\\]\n\n\n5.6.2 Fixed points\nThe fixed points of Equation 5.6 are identified in the usual manner, i.e. by seeking \\(({n_1}^*,{n_2}^*)\\) such that\n\\[\nf({n_1}^*,{n_2}^*)=g({n_1}^*,{n_2}^*)=0.\n\\]\nThe fixed point equations are \\[\n{n_1}^*\\left(1- {n_1}^*-a_{12}{n_2}^*\\right)=0 \\ \\ \\ \\ {n_2}^*\\left(1-{n_2}^*-a_{21}{n_1}^*\\right)=0.\n\\] The first equation has solution \\[\nn_1^*=0\n\\] or \\[\n\\left(1- {n_1}^*-a_{12}{n_2}^*\\right) \\implies n_2=\\frac{1}{a_{12}}(1-n_1^*).\n\\] Consider \\(n_1^*=0\\). Substitution in the second equation yields \\[\n{n_2}^*\\left(1-{n_2}^*\\right)=0.\n\\] Hence either \\(n_2^*=0\\) or \\(n_2^*=1\\). Hence two steady states are \\((0,0)\\) and \\((0,1).\\)\nNow consider \\(n_2^*=\\frac{1}{a_{12}}(1-n_1^*)\\) with \\(n_1^*\\neq0\\).\nSubstitution in the second fixed point equation yields \\[\n\\frac{1}{a_{12}}(1-n_1^*) \\left(1- \\frac{1}{a_{12}}(1-n_1^*) -a_{21}{n_1}^*\\right)\n\\] Hence either \\(n_1^*=1\\) or \\[\n\\left(1- \\frac{1}{a_{12}}(1-n_1^*) -a_{21}{n_1}^*\\right)=0 \\implies n_1^*=\\frac{1-a_{12}}{1-a_{12}a_{21}}.\n\\] In the case where \\(n_1^*=1\\), we find that \\(n_2^*=0\\). Hence the fixed point is (1,0).\nIn the case where \\[\nn_1^*=\\frac{1-a_{12}}{1-a_{12}a_{21}}\n\\] we find that \\[\nn_2^*=\\frac{1-a_{21}}{1-a_{12}a_{21}}\n\\] Hence the fixed point is \\[\n\\left(\\frac{1-a_{12}}{1-a_{12}a_{21}},\\frac{1-a_{21}}{1-a_{12}a_{21}}\\right).\n\\]\n\n\n5.6.3 Nullclines\nThe nullclines for Equation 5.6 are straight lines given by\n\\[\nn_1=0 \\ \\ \\ \\ \\ n_2=\\frac{1-n_1}{a_{12}},\n\\]\nand\n\\[\nn_2=0 \\ \\  \\ \\  \\ n_2= 1-a_{21}n_1.\n\\]\nNote that the fixed points \\((0,0)\\), \\((1,0)\\) and \\((0,1)\\) are always biologically relevant (i.e. independently of the parameter values for \\(a_{12}\\) and \\(a_{21}\\)).\nHowever, the coexistence fixed point is only biologically relevant if the nullclines intersect in the positive quadrant and this occurs only in certain regions of the model’s parameter space.\nIn the cases where \\(a_{12},a_{21}&lt;1\\) and \\(a_{12},a_{21}&gt;1\\) there is a coexistence fixed point (i.e. the nullclines intersect in the positive quadrant).\nHowever, if \\(a_{21}&lt;1\\) and \\(a_{12}&gt;1\\) or \\(a_{12}&lt;1\\) and \\(a_{21}&gt;1\\) there is not a biologically relevant, coexistence fixed point (i.e. the nullclines do not intersect in the positive quadrant).\nHence there are are four qualitatively different types of solution to consider.\n\n\n5.6.4 Linear stability\nThe linear stability of the different fixed points is determined by calculating the Jacobian matrix\n\\[\nA=\\left(\\begin{array}{rr}\n\\frac{\\partial f}{\\partial n_1}&\\frac{\\partial f}{\\partial n_2} \\\\ \\frac{\\partial g}{\\partial n_1 }&\\frac{\\partial g}{\\partial n_2} \\end{array}\\right)_{({n_1}^*,{n_2}^*)} = \\left(\\begin{array}{rr}\n1-2n_1 -a_{12}n_2&-a_{12}n_1 \\\\ -\\rho a_{21}n_2 &\\rho(1-2n_2-a_{21}n_1)\\end{array}\\right)_{({n_1}^*,{n_2}^*)}.\n\\]\nAt (0,0)\n\\[\nA=\\left(\\begin{array}{rr}\n1& 0 \\\\ 0 & \\rho\\end{array}\\right).\n\\]\nHence the eigenvalues of the Jacobian are \\(1\\) and \\(\\rho\\). As \\(\\rho&gt;0\\), the origin is therefore an unstable node (there are two real positive eigenvalues).\nAt (1,0)\n\\[\nA=\\left(\\begin{array}{rr}\n-1& -a_{12} \\\\ 0 & \\rho(1-a_{21})\\end{array}\\right).\n\\]\nThe trace and determinant are given by\n\\[\n\\det{A}=\\rho  (a_{21}-1)\\ \\ \\ \\textrm{and} \\ \\ \\ \\mathrm{tr}{A}=-1+\\rho(1-a_{21}).\n\\]\nHence if \\(a_{21}&lt;1\\), \\(\\det{A}&lt;0\\) and (1,0) is a saddle point and thus unstable (see Figure 4.1).\nIf \\(a_{21}&gt;1\\), \\(\\det{A}&gt;0\\) and \\(\\mathrm{tr}{A}&lt;0\\). Hence (1,0) is a stable node.\nHence the parameter \\(a_{21}\\), which describes how strongly Population 1 inhibits the growth rate of Population 2, determines whether or not the fixed point representing extinction of Population 2 but not Population 1 is stable or not.\nAt (0,1)\n\\[\nA=\\left(\\begin{array}{rr}\n1-a_{12}& 0\\\\  -\\rho a_{21} & -\\rho \\end{array}\\right).\n\\]\nIn this case if \\(a_{12}&lt;1\\), \\(\\det{A}&lt;0\\) and (0,1) is a saddle point. If \\(a_{12}&gt;1\\), \\(\\det{A}&gt;0\\) and \\(\\mathrm{tr}{A}&lt;0\\) and (0,1) is a stable node. Hence the parameter \\(a_{12}\\), which describes how strongly Population 2 inhibits the growth rate of Population 1, determines whether or not the fixed point representing extinction of Population 1 but not Population 2 is stable or not.\nAt the coexistence fixed point, recall the fixed point is\n\\[\n\\left(\\frac{1-a_{12}}{1-a_{12}a_{21}},\\frac{1-a_{21}}{1-a_{12}a_{21}}\\right).\n\\] Note that this fixed point is only biologically relevant in the cases \\(a_{21}&lt;1, a_{12}&lt;1\\) or \\(a_{21}&gt;1, a_{12}&gt;1\\). Evaluating the Jacobian yields \\[\nA=\\frac{1}{1-a_{12}a_{21}}\\left(\\begin{array}{rr}\na_{12}-1  & -a_{12}(1-a_{12})\\\\ -\\rho a_{21}(1-a_{21}) &\\rho(a_{21}-1)\\end{array}\\right).\n\\]\nThe determinant and trace of the Jacobian are given by\n\\[\n\\begin{aligned}\n\\det{A}&=\\rho\\left((a_{12}-1)(a_{21}-1)-a_{12}a_{21}(1-a_{12})(1-a_{21})\\right)\\frac{1}{(1-a_{12}a_{21})^2}, \\nonumber \\\\\n&= \\rho\\frac{(a_{12}-1)(a_{21}-1)}{(1-a_{12}a_{21})},\n\\end{aligned}\n\\]\nand\n\\[\n\\mathrm{tr}{A}=\\left(a_{12}-1+\\rho(a_{21}-1)\\right) \\frac{1}{1-a_{12}a_{21}},\n\\] respectively.\nLet’s firstly consider the case where \\(a_{21}&lt;1\\) and \\(a_{21}&lt;1\\). This implies that \\(a_{21}-1&lt;0\\) and \\(a_{12}-1&lt;0\\), hence evaluating the signs of the different products yields\n\\[\n\\det{A} = \\rho(-)(-)(+)&gt;0\n\\] and \\[\n\\mathrm{tr}{A}= \\rho(-) + (-)&lt;0.\n\\]\nTherefore the coexistence fixed point is a stable node or spiral.\nIn the case where \\(a_{21}&gt;1\\) and \\(a_{12}&gt;1\\)\n\\[\n\\det{A} = \\rho(+)(+)(-)&lt;0 .\n\\]\nHence the coexistence fixed point is a saddle.\n\n\n5.6.5 Phase portrait\nSee Figure 5.2 for phase portraits of three of the four cases that we have considered. It is expected that you can sketch phase portraits. Key details to consider are the fixed points and their linear stability. You should also sketch the nullclines and depict the sign of the derivatives in the phase plane on either side of the nullclines. You should also sketch one or more sample trajectories.\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport scipy\nfrom scipy.integrate import odeint\n\n# Define model parameters\nrho=1.5\na_12=0.5\na_21=0.5\n\n# Define rhs of ODEs\ndef rhs_comp_model(x,t):\n  rhs=np.zeros_like(x)\n  n_1=x[0]\n  n_2=x[1]\n  dn_1_dt=n_1*(1-n_1)-a_12*n_1*n_2\n  dn_2_dt=rho*(n_2*(1-n_2)-a_21*n_1*n_2)\n  rhs[0]=dn_1_dt\n  rhs[1]=dn_2_dt\n  return rhs\n\n# Define discretised time domain\nt = np.linspace(0, 10, 1000)\n\n# Define IC\ninit_cond=[0.5,0.5]\n\n# Numerically integrate ODes\nsol1 = odeint(rhs_comp_model, init_cond,t)\n\n# PLot results\nn_1=sol1[:,0]\nn_2=sol1[:,1]\n\nfig, ax=plt.subplots()\nax.plot(t, n_1, 'b',t,n_2,'r')\n\nax.legend(['$n_1$','$n_2$'],loc='best')\nax.set_xlabel('t')\nplt.grid()\nplt.show()\n\n\n\n\n\n\n\n\nFigure 5.1: Numerical solutions of competition model\n\n\n\n\n\n\n\nCode\n# Phase plane for the competition model \nimport numpy as np\nimport matplotlib.pyplot as plt\nimport scipy\nfrom scipy.integrate import odeint\n\n\n# Discretise n domain\nn_1_vec=np.linspace(0,5,100)\n\n\n# COmpute different elements of the phase plane\ndef ComputeCompetitionSol(a_12,a_21,n_1_vec):\n    t = np.linspace(0, 10, 1000)\n\n    # Different ICs for integrating trajectories\n    init_cond1=[0.75,0.75]\n    init_cond2=[0.15,0.15]\n    init_cond3=[2.5,0.5]\n\n    # Integrate the ODEs\n    alpha=2.0\n    sol1 = odeint(rhs_comp_model, init_cond1,t)\n    sol2 = odeint(rhs_comp_model, init_cond2,t)\n    sol3 = odeint(rhs_comp_model, init_cond3,t)\n\n    # determine which case we are in\n    num_steady_states=3\n    fourth_ss_condition= ((a_12&lt;1) & (a_21&lt;1)) | ((a_12&gt;1) & (a_21&gt;1))\n    if fourth_ss_condition==True:\n        num_steady_states=4\n\n    # Compute the steady dstates\n    ss=np.zeros((num_steady_states,2),dtype=float)\n    ss[0,:]=[0,0]\n    ss[1,:]=[1,0]\n    ss[2,:]=[0,1]\n    if fourth_ss_condition==True:\n        ss[3,:]=[(1-a_12)/(1-a_12*a_21),(1-a_21)/(1-a_12*a_21)]\n\n\n    # Compute the nullclines\n    n1_ncline_1_n_1=[0,0]    \n    n1_ncline_1_n_2=[0,5]   \n    n1_ncline_2_n_2=1/a_12*(1-n_1_vec)\n    n2_ncline_1_n_1=[0,5]    \n    n2_ncline_1_n_2=[0,0]   \n    n2_ncline_2_n_2=1-a_21*(n_1_vec)\n\n    # Return the various computed QUANTITIES\n    return sol1,sol2,sol3,ss,n1_ncline_1_n_1,n1_ncline_1_n_2,n1_ncline_2_n_2,n2_ncline_1_n_1,n2_ncline_1_n_2,n2_ncline_2_n_2\n\n# Compute quantities\na_12=0.5\na_21=0.4\nsol1,sol2,sol3,ss, n1_ncline_1_n_1,n1_ncline_1_n_2,n1_ncline_2_n_2,n2_ncline_1_n_1,n2_ncline_1_n_2,n2_ncline_2_n_2=ComputeCompetitionSol(a_12,a_21,n_1_vec)\n\n# PLot phase plane\nfig, ax = plt.subplots(1,2)\nax[0].plot(n1_ncline_1_n_1,n1_ncline_1_n_2,'k--')\nax[0].plot(n_1_vec,n1_ncline_2_n_2,'k--')\nax[0].plot(n2_ncline_1_n_1,n2_ncline_1_n_2,'r--')\nax[0].plot(n_1_vec,n2_ncline_2_n_2,'r--')\n\nax[0].plot(sol1[:,0],sol1[:,1],sol2[:,0],sol2[:,1],sol3[:,0],sol3[:,1])\nax[0].plot(ss[:,0],ss[:,1],'k*')\nax[0].set_xlabel('$n_1$')\nax[0].set_ylabel('$n_2$')\n\nax[0].set_xlim([-0.05,1.5])\nax[0].set_ylim([-0.05,1.5])\n\n# Compoute quantitied for different parameters\na_12=1.5\na_21=0.4\nsol1,sol2,sol3,ss, n1_ncline_1_n_1,n1_ncline_1_n_2,n1_ncline_2_n_2,n2_ncline_1_n_1,n2_ncline_1_n_2,n2_ncline_2_n_2=ComputeCompetitionSol(a_12,a_21,n_1_vec)\n\n# PLot phase plane\nax[1].plot(n1_ncline_1_n_1,n1_ncline_1_n_2,'k--')\nax[1].plot(n_1_vec,n1_ncline_2_n_2,'k--')\nax[1].plot(n2_ncline_1_n_1,n2_ncline_1_n_2,'r--')\nax[1].plot(n_1_vec,n2_ncline_2_n_2,'r--')\n\nax[1].plot(sol1[:,0],sol1[:,1],sol2[:,0],sol2[:,1],sol3[:,0],sol3[:,1])\nax[1].plot(ss[:,0],ss[:,1],'k*')\nax[1].set_xlabel('$n_1$')\nax[1].set_ylabel('$n_2$')\n\nax[1].set_xlim([-0.05,1.5])\nax[1].set_ylim([-0.05,1.5])\n\nplt.tight_layout()\nplt.grid()\nplt.show()\n\n\n\n\n\n\n\n\nFigure 5.2: Numerical solution of the competition model\n\n\n\n\n\n\n\n5.6.6 Insight\nThe model therefore has four qualitatively different behaviours that are described as follows: Consider the case where \\(a_{21}&gt;1\\). This represents the case of Population 1 strongly competing with Population 2.\n\nIf \\(a_{12}&gt;1\\), Population 2 also strongly competes with Population 1. In this case, there are four biologically relevant fixed points, two of which are stable (1,0) and (0,1). The coexistence fixed point is a saddle and thus unstable. The model is bistable and the initial conditions determine whether solutions end up at (1,0) or (0,1) (see Figure 5.2). The biological interpretation of this solution is that one species will always win and completely outcompete the other. Even if the two populations are equal (\\(K_1=K_2\\) and \\(a_{21}=a_{12}&gt;1\\)), one species will always win and the other will become extinct.\nIf \\(a_{12}&lt;1\\), Population 2 weakly competes with Population 1. There is no coexistence fixed point and the only stable fixed point is (1,0). Hence Population 1 always wins and Population 2 always becomes extinct.\n\nNow consider the case where \\(a_{21}&lt;1\\). This represents the case of Population 1 weakly competing with Population 2.\n\nIf \\(a_{12}&gt;1\\), Population 2 strongly competes with Population 1. There is nonexistence fixed point and the only stable fixed point is (0,1). Hence Population 2 always wins and Population 1 always becomes extinct.\nIf \\(a_{12}&lt;1\\), Population 2 also weakly competes with Population 1. The coexistence fixed point is stable and the fixed points (1,0) and (0,1) are unstable.\n\n\nExample 5.3 Consider a particle of mass 1 moving in double well potential \\[\nV(x)=-\\frac{1}{2}x^2+\\frac{1}{4}x^4.\n\\]\nThe equation of motion is \\[\nm\\ddot{x}=-\\frac{dV}{dx}.\n\\] Find and classify all the fixed points for the system. Plot the phase portrait and provide an interpretation for the results.",
    "crumbs": [
      "2D flows",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>2D nonlinear systems</span>"
    ]
  },
  {
    "objectID": "PythonAppendix.html",
    "href": "PythonAppendix.html",
    "title": "6  Python",
    "section": "",
    "text": "6.1 Symbolic calculations\nSymbolic calculations ahve been performed using the Python library Sympy.\nThis library comes with tutorials.\nYou are encouraged to familiarise yourself with the syntax by working through some of the tutorial examples provided at the links above.\nMany of the calculations that we do throughout the course involve solving systems of algebraic equations",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Python</span>"
    ]
  },
  {
    "objectID": "PythonAppendix.html#numerical-solution-of-difference-equations",
    "href": "PythonAppendix.html#numerical-solution-of-difference-equations",
    "title": "6  Python",
    "section": "6.2 Numerical solution of difference equations",
    "text": "6.2 Numerical solution of difference equations\nDifference equations have been solved using a for loop. Routinse have been written to solve either single or coupled system of difference equaitons.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Python</span>"
    ]
  },
  {
    "objectID": "PythonAppendix.html#numerical-integration-of-odes",
    "href": "PythonAppendix.html#numerical-integration-of-odes",
    "title": "6  Python",
    "section": "6.3 Numerical integration of ODEs",
    "text": "6.3 Numerical integration of ODEs\nThroughout the notes systems of ODEs have been integrated using the Scipy function odeint.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Python</span>"
    ]
  },
  {
    "objectID": "PythonAppendix.html#plotting",
    "href": "PythonAppendix.html#plotting",
    "title": "6  Python",
    "section": "6.4 Plotting",
    "text": "6.4 Plotting\nLine graphs are plotted using the Python library Matplotlib.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Python</span>"
    ]
  }
]